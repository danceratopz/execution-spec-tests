
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A collection of test cases implemented in Python for Ethereum execution clients">
      
      
      
        <link rel="canonical" href="https://danceratopz.github.io/execution-spec-tests/tests/eips/eip4844/test_blobhash_opcode/">
      
      
        <link rel="prev" href="../test_blob_txs/">
      
      
        <link rel="next" href="../test_blobhash_opcode_contexts/">
      
      <link rel="icon" href="../../../../img/ETH-logo-icon.svg">
      <meta name="generator" content="mkdocs-1.4.3, mkdocs-material-9.1.14">
    
    
      
        <title>Test Blobhash Opcode - Ethereum Execution Spec Tests</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.85bb2934.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.a6bdf11c.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
      
        <meta  property="og:type"  content="website" >
      
        <meta  property="og:title"  content="Test Blobhash Opcode - Ethereum Execution Spec Tests" >
      
        <meta  property="og:description"  content="A collection of test cases implemented in Python for Ethereum execution clients" >
      
        <meta  property="og:image"  content="https://danceratopz.github.io/execution-spec-tests/assets/images/social/tests/eips/eip4844/test_blobhash_opcode.png" >
      
        <meta  property="og:image:type"  content="image/png" >
      
        <meta  property="og:image:width"  content="1200" >
      
        <meta  property="og:image:height"  content="630" >
      
        <meta  property="og:url"  content="https://danceratopz.github.io/execution-spec-tests/tests/eips/eip4844/test_blobhash_opcode/" >
      
        <meta  name="twitter:card"  content="summary_large_image" >
      
        <meta  name="twitter:title"  content="Test Blobhash Opcode - Ethereum Execution Spec Tests" >
      
        <meta  name="twitter:description"  content="A collection of test cases implemented in Python for Ethereum execution clients" >
      
        <meta  name="twitter:image"  content="https://danceratopz.github.io/execution-spec-tests/assets/images/social/tests/eips/eip4844/test_blobhash_opcode.png" >
      
    
    
   <link href="../../../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
        html.glightbox-open { overflow: initial; height: 100%; }
        .gslide-title { margin-top: 0px; user-select: text; }
        .gslide-desc { color: #666; user-select: text; }
        .gslide-image img { background: white; }
        
            .gscrollbar-fixer { padding-right: 15px; }
            .gdesc-inner { font-size: 0.75rem; }
            body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
            body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
            body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}
            </style> <script src="../../../../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#test-blobhash-opcode" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="Ethereum Execution Spec Tests" class="md-header__button md-logo" aria-label="Ethereum Execution Spec Tests" data-md-component="logo">
      
  <img src="../../../../img/Ethereum-logo-600px.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Ethereum Execution Spec Tests
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Test Blobhash Opcode
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
          
            
            
            
            <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
            
              <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_3" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9h-1.9M20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69m-9.15 3.96h2.3L12 9l-1.15 3.65Z"/></svg>
              </label>
            
          
            
            
            
            <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_2">
            
              <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
              </label>
            
          
            
            
            
            <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_3">
            
              <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_2" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
              </label>
            
          
        </form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/ethereum/execution-spec-tests" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    execution-spec-tests
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../../../.." class="md-tabs__link">
      Overview
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../../getting_started/quick_start/" class="md-tabs__link">
        Getting Started
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../../writing_tests/" class="md-tabs__link">
        Writing Tests
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../../tutorials/state_transition/" class="md-tabs__link">
        Tutorials
      </a>
    </li>
  

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../../../getting_help/" class="md-tabs__link">
      Getting Help
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../../dev/" class="md-tabs__link">
        Developer Doc
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../../library/" class="md-tabs__link">
        Library Reference
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../" class="md-tabs__link md-tabs__link--active">
        Test case reference
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="Ethereum Execution Spec Tests" class="md-nav__button md-logo" aria-label="Ethereum Execution Spec Tests" data-md-component="logo">
      
  <img src="../../../../img/Ethereum-logo-600px.png" alt="logo">

    </a>
    Ethereum Execution Spec Tests
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/ethereum/execution-spec-tests" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    execution-spec-tests
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../.." class="md-nav__link">
        Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          Getting Started
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Getting Started
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../getting_started/quick_start/" class="md-nav__link">
        Quick Start
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../getting_started/setup_vs_code/" class="md-nav__link">
        VS Code Setup
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../getting_started/repository_overview/" class="md-nav__link">
        Repository Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../getting_started/executing_tests_command_line/" class="md-nav__link">
        Executing Tests at a Prompt
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../getting_started/executing_tests_vs_code/" class="md-nav__link">
        Executing Tests in VS Code
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../getting_started/executing_tests_dev_fork/" class="md-nav__link">
        Executing Tests for Features Under Development
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
      
      
        
          
            
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../../writing_tests/">Writing Tests</a>
          
            <label for="__nav_3">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Writing Tests
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../writing_tests/code_standards/" class="md-nav__link">
        Code Standards
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../writing_tests/types_of_tests/" class="md-nav__link">
        Types of Test
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../writing_tests/adding_a_new_test/" class="md-nav__link">
        Adding a New Test
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../writing_tests/writing_a_new_test/" class="md-nav__link">
        Writing a New Test
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../writing_tests/reference_specification/" class="md-nav__link">
        Referencing an EIP Spec Version
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../writing_tests/verifying_changes/" class="md-nav__link">
        Verifying Changes Locally
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          Tutorials
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Tutorials
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../tutorials/state_transition/" class="md-nav__link">
        State Transition Tests
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../../getting_help/" class="md-nav__link">
        Getting Help
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
      
      
        
          
            
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../../dev/">Developer Doc</a>
          
            <label for="__nav_6">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Developer Doc
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../dev/docs/" class="md-nav__link">
        Documentation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../dev/coding_style/" class="md-nav__link">
        Coding Style
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
      
      
        
          
            
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../../library/">Library Reference</a>
          
            <label for="__nav_7">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Library Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../library/evm_transition_tool/" class="md-nav__link">
        EVM Transition Tool Package
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../library/evm_block_builder/" class="md-nav__link">
        EVM Block Builder Package
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../library/ethereum_test_tools/" class="md-nav__link">
        Ethereum Test Tools Package
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../library/ethereum_test_forks/" class="md-nav__link">
        Ethereum Test Forks Package
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_6" >
      
      
        
          
            
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../../library/pytest_plugins/">Pytest Plugins</a>
          
            <label for="__nav_7_6">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7_6">
          <span class="md-nav__icon md-icon"></span>
          Pytest Plugins
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../library/pytest_plugins/forks/" class="md-nav__link">
        Forks
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../library/pytest_plugins/test_filler/" class="md-nav__link">
        Test Filler
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../library/pytest_plugins/spec_version_checker/" class="md-nav__link">
        Spec Version Checker
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" checked>
      
      
        
          
            
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../">Test case reference</a>
          
            <label for="__nav_8">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          Test case reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_2" checked>
      
      
        
          
            
          
        
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../">EIPs</a>
          
            <label for="__nav_8_2">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_2_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_8_2">
          <span class="md-nav__icon md-icon"></span>
          EIPs
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../test_eip3651/" class="md-nav__link">
        Test EIP-3651
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../test_eip3855/" class="md-nav__link">
        Test EIP-3855
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../test_eip3860/" class="md-nav__link">
        Test EIP-3860
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_2_5" checked>
      
      
        
          
            
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../">EIP-4844</a>
          
            <label for="__nav_8_2_5">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_8_2_5_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_8_2_5">
          <span class="md-nav__icon md-icon"></span>
          EIP-4844
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../test_cases/" class="md-nav__link">
        Test cases
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../test_blob_txs/" class="md-nav__link">
        Test Blob Txs
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Test Blobhash Opcode
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Test Blobhash Opcode
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#tests.eips.eip4844.test_blobhash_opcode" class="md-nav__link">
    tests.eips.eip4844.test_blobhash_opcode
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tests.eips.eip4844.test_blobhash_opcode.blob_tx" class="md-nav__link">
    blob_tx()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tests.eips.eip4844.test_blobhash_opcode.test_blobhash_gas_cost" class="md-nav__link">
    test_blobhash_gas_cost()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tests.eips.eip4844.test_blobhash_opcode.to_address" class="md-nav__link">
    to_address()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tests.eips.eip4844.test_blobhash_opcode.CodeGasMeasure" class="md-nav__link">
    CodeGasMeasure
  </a>
  
    <nav class="md-nav" aria-label="CodeGasMeasure">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.code.generators.CodeGasMeasure.code" class="md-nav__link">
    code
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.code.generators.CodeGasMeasure.overhead_cost" class="md-nav__link">
    overhead_cost
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.code.generators.CodeGasMeasure.extra_stack_items" class="md-nav__link">
    extra_stack_items
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.code.generators.CodeGasMeasure.sstore_key" class="md-nav__link">
    sstore_key
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.code.generators.CodeGasMeasure.assemble" class="md-nav__link">
    assemble()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tests.eips.eip4844.test_blobhash_opcode.to_hash_bytes" class="md-nav__link">
    to_hash_bytes()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tests.eips.eip4844.test_blobhash_opcode.test_blobhash_scenarios" class="md-nav__link">
    test_blobhash_scenarios()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tests.eips.eip4844.test_blobhash_opcode.Op" class="md-nav__link">
    Op
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tests.eips.eip4844.test_blobhash_opcode.test_blobhash_invalid_blob_index" class="md-nav__link">
    test_blobhash_invalid_blob_index()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tests.eips.eip4844.test_blobhash_opcode.test_blobhash_multiple_txs_in_block" class="md-nav__link">
    test_blobhash_multiple_txs_in_block()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tests.eips.eip4844.test_blobhash_opcode.BlobhashScenario" class="md-nav__link">
    BlobhashScenario
  </a>
  
    <nav class="md-nav" aria-label="BlobhashScenario">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tests.eips.eip4844.util_blobhash.BlobhashScenario.create_blob_hashes_list" class="md-nav__link">
    create_blob_hashes_list()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tests.eips.eip4844.util_blobhash.BlobhashScenario.blobhash_sstore" class="md-nav__link">
    blobhash_sstore()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tests.eips.eip4844.util_blobhash.BlobhashScenario.generate_blobhash_bytecode" class="md-nav__link">
    generate_blobhash_bytecode()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tests.eips.eip4844.test_blobhash_opcode.Account" class="md-nav__link">
    Account
  </a>
  
    <nav class="md-nav" aria-label="Account">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.common.types.Account.nonce" class="md-nav__link">
    nonce
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.common.types.Account.balance" class="md-nav__link">
    balance
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.common.types.Account.code" class="md-nav__link">
    code
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.common.types.Account.storage" class="md-nav__link">
    storage
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.common.types.Account.NonceMismatch" class="md-nav__link">
    NonceMismatch
  </a>
  
    <nav class="md-nav" aria-label="NonceMismatch">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.common.types.Account.NonceMismatch.__str__" class="md-nav__link">
    __str__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.common.types.Account.BalanceMismatch" class="md-nav__link">
    BalanceMismatch
  </a>
  
    <nav class="md-nav" aria-label="BalanceMismatch">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.common.types.Account.BalanceMismatch.__str__" class="md-nav__link">
    __str__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.common.types.Account.CodeMismatch" class="md-nav__link">
    CodeMismatch
  </a>
  
    <nav class="md-nav" aria-label="CodeMismatch">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.common.types.Account.CodeMismatch.__str__" class="md-nav__link">
    __str__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.common.types.Account.__post_init__" class="md-nav__link">
    __post_init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.common.types.Account.check_alloc" class="md-nav__link">
    check_alloc()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.common.types.Account.with_code" class="md-nav__link">
    with_code()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tests.eips.eip4844.test_blobhash_opcode.Transaction" class="md-nav__link">
    Transaction
  </a>
  
    <nav class="md-nav" aria-label="Transaction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.common.types.Transaction.ty" class="md-nav__link">
    ty
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.common.types.Transaction.InvalidFeePayment" class="md-nav__link">
    InvalidFeePayment
  </a>
  
    <nav class="md-nav" aria-label="InvalidFeePayment">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.common.types.Transaction.InvalidFeePayment.__str__" class="md-nav__link">
    __str__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.common.types.Transaction.InvalidSignaturePrivateKey" class="md-nav__link">
    InvalidSignaturePrivateKey
  </a>
  
    <nav class="md-nav" aria-label="InvalidSignaturePrivateKey">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.common.types.Transaction.InvalidSignaturePrivateKey.__str__" class="md-nav__link">
    __str__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.common.types.Transaction.__post_init__" class="md-nav__link">
    __post_init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.common.types.Transaction.with_error" class="md-nav__link">
    with_error()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.common.types.Transaction.with_nonce" class="md-nav__link">
    with_nonce()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.common.types.Transaction.with_fields" class="md-nav__link">
    with_fields()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tests.eips.eip4844.test_blobhash_opcode.Block" class="md-nav__link">
    Block
  </a>
  
    <nav class="md-nav" aria-label="Block">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.common.types.Block.rlp" class="md-nav__link">
    rlp
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.common.types.Block.rlp_modifier" class="md-nav__link">
    rlp_modifier
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.common.types.Block.exception" class="md-nav__link">
    exception
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.common.types.Block.txs" class="md-nav__link">
    txs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.common.types.Block.ommers" class="md-nav__link">
    ommers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.common.types.Block.withdrawals" class="md-nav__link">
    withdrawals
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.common.types.Block.set_environment" class="md-nav__link">
    set_environment()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.common.types.Block.copy_with_rlp" class="md-nav__link">
    copy_with_rlp()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../test_blobhash_opcode_contexts/" class="md-nav__link">
        Test Blobhash Opcode Contexts
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../test_excess_data_gas/" class="md-nav__link">
        Test Excess Data Gas
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../test_excess_data_gas_fork_transition/" class="md-nav__link">
        Test Excess Data Gas Fork Transition
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../test_point_evaluation_precompile/" class="md-nav__link">
        Test Point Evaluation Precompile
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../test_point_evaluation_precompile_gas/" class="md-nav__link">
        Test Point Evaluation Precompile Gas
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../util_blobhash/" class="md-nav__link">
        Util Blobhash
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_2_5_11" >
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_8_2_5_11" id="__nav_8_2_5_11_label" tabindex="0">
          Point Evaluation Vectors
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_8_2_5_11_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_8_2_5_11">
          <span class="md-nav__icon md-icon"></span>
          Point Evaluation Vectors
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../point_evaluation_vectors/test_cases/" class="md-nav__link">
        Test cases
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_3" >
      
      
        
          
            
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../example/">Example</a>
          
            <label for="__nav_8_3">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_8_3">
          <span class="md-nav__icon md-icon"></span>
          Example
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../example/test_acl_example/" class="md-nav__link">
        Test ACL Example
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../example/test_yul_example/" class="md-nav__link">
        Test Yul Example
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_4" >
      
      
        
          
            
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../security/">Security</a>
          
            <label for="__nav_8_4">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_8_4">
          <span class="md-nav__icon md-icon"></span>
          Security
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../security/test_selfdestruct_balance_bug/" class="md-nav__link">
        Test Selfdestruct Balance Bug
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_5" >
      
      
        
          
            
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../vm/">VM</a>
          
            <label for="__nav_8_5">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_8_5">
          <span class="md-nav__icon md-icon"></span>
          VM
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../vm/test_chain_id/" class="md-nav__link">
        Test Chain Id
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../vm/test_dup/" class="md-nav__link">
        Test Dup
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_6" >
      
      
        
          
            
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../withdrawals/">Withdrawals</a>
          
            <label for="__nav_8_6">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_8_6">
          <span class="md-nav__icon md-icon"></span>
          Withdrawals
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../withdrawals/test_withdrawals/" class="md-nav__link">
        Test Withdrawals
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#tests.eips.eip4844.test_blobhash_opcode" class="md-nav__link">
    tests.eips.eip4844.test_blobhash_opcode
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tests.eips.eip4844.test_blobhash_opcode.blob_tx" class="md-nav__link">
    blob_tx()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tests.eips.eip4844.test_blobhash_opcode.test_blobhash_gas_cost" class="md-nav__link">
    test_blobhash_gas_cost()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tests.eips.eip4844.test_blobhash_opcode.to_address" class="md-nav__link">
    to_address()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tests.eips.eip4844.test_blobhash_opcode.CodeGasMeasure" class="md-nav__link">
    CodeGasMeasure
  </a>
  
    <nav class="md-nav" aria-label="CodeGasMeasure">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.code.generators.CodeGasMeasure.code" class="md-nav__link">
    code
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.code.generators.CodeGasMeasure.overhead_cost" class="md-nav__link">
    overhead_cost
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.code.generators.CodeGasMeasure.extra_stack_items" class="md-nav__link">
    extra_stack_items
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.code.generators.CodeGasMeasure.sstore_key" class="md-nav__link">
    sstore_key
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.code.generators.CodeGasMeasure.assemble" class="md-nav__link">
    assemble()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tests.eips.eip4844.test_blobhash_opcode.to_hash_bytes" class="md-nav__link">
    to_hash_bytes()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tests.eips.eip4844.test_blobhash_opcode.test_blobhash_scenarios" class="md-nav__link">
    test_blobhash_scenarios()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tests.eips.eip4844.test_blobhash_opcode.Op" class="md-nav__link">
    Op
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tests.eips.eip4844.test_blobhash_opcode.test_blobhash_invalid_blob_index" class="md-nav__link">
    test_blobhash_invalid_blob_index()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tests.eips.eip4844.test_blobhash_opcode.test_blobhash_multiple_txs_in_block" class="md-nav__link">
    test_blobhash_multiple_txs_in_block()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tests.eips.eip4844.test_blobhash_opcode.BlobhashScenario" class="md-nav__link">
    BlobhashScenario
  </a>
  
    <nav class="md-nav" aria-label="BlobhashScenario">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tests.eips.eip4844.util_blobhash.BlobhashScenario.create_blob_hashes_list" class="md-nav__link">
    create_blob_hashes_list()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tests.eips.eip4844.util_blobhash.BlobhashScenario.blobhash_sstore" class="md-nav__link">
    blobhash_sstore()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tests.eips.eip4844.util_blobhash.BlobhashScenario.generate_blobhash_bytecode" class="md-nav__link">
    generate_blobhash_bytecode()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tests.eips.eip4844.test_blobhash_opcode.Account" class="md-nav__link">
    Account
  </a>
  
    <nav class="md-nav" aria-label="Account">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.common.types.Account.nonce" class="md-nav__link">
    nonce
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.common.types.Account.balance" class="md-nav__link">
    balance
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.common.types.Account.code" class="md-nav__link">
    code
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.common.types.Account.storage" class="md-nav__link">
    storage
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.common.types.Account.NonceMismatch" class="md-nav__link">
    NonceMismatch
  </a>
  
    <nav class="md-nav" aria-label="NonceMismatch">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.common.types.Account.NonceMismatch.__str__" class="md-nav__link">
    __str__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.common.types.Account.BalanceMismatch" class="md-nav__link">
    BalanceMismatch
  </a>
  
    <nav class="md-nav" aria-label="BalanceMismatch">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.common.types.Account.BalanceMismatch.__str__" class="md-nav__link">
    __str__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.common.types.Account.CodeMismatch" class="md-nav__link">
    CodeMismatch
  </a>
  
    <nav class="md-nav" aria-label="CodeMismatch">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.common.types.Account.CodeMismatch.__str__" class="md-nav__link">
    __str__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.common.types.Account.__post_init__" class="md-nav__link">
    __post_init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.common.types.Account.check_alloc" class="md-nav__link">
    check_alloc()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.common.types.Account.with_code" class="md-nav__link">
    with_code()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tests.eips.eip4844.test_blobhash_opcode.Transaction" class="md-nav__link">
    Transaction
  </a>
  
    <nav class="md-nav" aria-label="Transaction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.common.types.Transaction.ty" class="md-nav__link">
    ty
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.common.types.Transaction.InvalidFeePayment" class="md-nav__link">
    InvalidFeePayment
  </a>
  
    <nav class="md-nav" aria-label="InvalidFeePayment">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.common.types.Transaction.InvalidFeePayment.__str__" class="md-nav__link">
    __str__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.common.types.Transaction.InvalidSignaturePrivateKey" class="md-nav__link">
    InvalidSignaturePrivateKey
  </a>
  
    <nav class="md-nav" aria-label="InvalidSignaturePrivateKey">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.common.types.Transaction.InvalidSignaturePrivateKey.__str__" class="md-nav__link">
    __str__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.common.types.Transaction.__post_init__" class="md-nav__link">
    __post_init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.common.types.Transaction.with_error" class="md-nav__link">
    with_error()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.common.types.Transaction.with_nonce" class="md-nav__link">
    with_nonce()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.common.types.Transaction.with_fields" class="md-nav__link">
    with_fields()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tests.eips.eip4844.test_blobhash_opcode.Block" class="md-nav__link">
    Block
  </a>
  
    <nav class="md-nav" aria-label="Block">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.common.types.Block.rlp" class="md-nav__link">
    rlp
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.common.types.Block.rlp_modifier" class="md-nav__link">
    rlp_modifier
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.common.types.Block.exception" class="md-nav__link">
    exception
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.common.types.Block.txs" class="md-nav__link">
    txs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.common.types.Block.ommers" class="md-nav__link">
    ommers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.common.types.Block.withdrawals" class="md-nav__link">
    withdrawals
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.common.types.Block.set_environment" class="md-nav__link">
    set_environment()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.common.types.Block.copy_with_rlp" class="md-nav__link">
    copy_with_rlp()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="test-blobhash-opcode">Test Blobhash Opcode<a class="headerlink" href="#test-blobhash-opcode" title="Permanent link">&para;</a></h1>
<div class="admonition example">
<p class="admonition-title">Generate fixtures for these test cases with:</p>
<div class="highlight"><pre><span></span><code><span class="go">fill -v tests/eips/eip4844/test_blobhash_opcode.py</span>
</code></pre></div>
</div>


<div class="doc doc-object doc-module">


<a id="tests.eips.eip4844.test_blobhash_opcode"></a>
  <div class="doc doc-contents first">
  
      <p>Test EIP-4844: BLOBHASH Opcode
EIP: https://eips.ethereum.org/EIPS/eip-4844</p>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-function">



<h2 id="tests.eips.eip4844.test_blobhash_opcode.blob_tx" class="doc doc-heading">
<code class="highlight language-python"><span class="n">blob_tx</span><span class="p">(</span><span class="n">template_tx</span><span class="p">)</span></code>

<a href="#tests.eips.eip4844.test_blobhash_opcode.blob_tx" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  
      <p>Blob transaction factory fixture.
Used to define blob txs with a specified to address, nonce &amp; type.</p>

      <details class="quote">
        <summary>Source code in <code>tests/eips/eip4844/test_blobhash_opcode.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
<span class="k">def</span> <span class="nf">blob_tx</span><span class="p">(</span><span class="n">template_tx</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Blob transaction factory fixture.</span>
<span class="sd">    Used to define blob txs with a specified to address, nonce &amp; type.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">_blob_tx</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="nb">type</span><span class="p">,</span> <span class="n">nonce</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">template_tx</span><span class="o">.</span><span class="n">with_fields</span><span class="p">(</span>
            <span class="n">ty</span><span class="o">=</span><span class="nb">type</span><span class="p">,</span>
            <span class="n">nonce</span><span class="o">=</span><span class="n">nonce</span><span class="p">,</span>
            <span class="n">to</span><span class="o">=</span><span class="n">address</span><span class="p">,</span>
            <span class="n">access_list</span><span class="o">=</span><span class="p">[],</span>
            <span class="n">max_priority_fee_per_gas</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
            <span class="n">blob_versioned_hashes</span><span class="o">=</span><span class="n">random_blob_hashes</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">MAX_BLOB_PER_BLOCK</span><span class="p">],</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">_blob_tx</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>






<div class="doc doc-object doc-function">



<h2 id="tests.eips.eip4844.test_blobhash_opcode.test_blobhash_gas_cost" class="doc doc-heading">
<code class="highlight language-python"><span class="n">test_blobhash_gas_cost</span><span class="p">(</span><span class="n">pre</span><span class="p">,</span> <span class="n">template_tx</span><span class="p">,</span> <span class="n">blocks</span><span class="p">,</span> <span class="n">post</span><span class="p">,</span> <span class="n">tx_type</span><span class="p">,</span> <span class="n">blockchain_test</span><span class="p">)</span></code>

<a href="#tests.eips.eip4844.test_blobhash_opcode.test_blobhash_gas_cost" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  
      <p>Test BLOBHASH opcode gas cost using a variety of indexes.</p>
<p>Asserts the gas consumption of the BLOBHASH opcode is correct by ensuring
it matches <code>HASH_OPCODE_GAS = 3</code>. Includes both valid and invalid random
index sizes from the range <code>[0, 2**256-1]</code>, for tx types 2 and 3.</p>

      <details class="quote">
        <summary>Source code in <code>tests/eips/eip4844/test_blobhash_opcode.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">parametrize</span><span class="p">(</span><span class="s2">&quot;tx_type&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">test_blobhash_gas_cost</span><span class="p">(</span>
    <span class="n">pre</span><span class="p">,</span>
    <span class="n">template_tx</span><span class="p">,</span>
    <span class="n">blocks</span><span class="p">,</span>
    <span class="n">post</span><span class="p">,</span>
    <span class="n">tx_type</span><span class="p">,</span>
    <span class="n">blockchain_test</span><span class="p">:</span> <span class="n">BlockchainTestFiller</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Test BLOBHASH opcode gas cost using a variety of indexes.</span>

<span class="sd">    Asserts the gas consumption of the BLOBHASH opcode is correct by ensuring</span>
<span class="sd">    it matches `HASH_OPCODE_GAS = 3`. Includes both valid and invalid random</span>
<span class="sd">    index sizes from the range `[0, 2**256-1]`, for tx types 2 and 3.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">gas_measures_code</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">CodeGasMeasure</span><span class="p">(</span>
            <span class="n">code</span><span class="o">=</span><span class="n">Op</span><span class="o">.</span><span class="n">BLOBHASH</span><span class="p">(</span><span class="n">i</span><span class="p">),</span>
            <span class="n">overhead_cost</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
            <span class="n">extra_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">blobhash_index_values</span>
    <span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">gas_code</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">gas_measures_code</span><span class="p">):</span>
        <span class="n">address</span> <span class="o">=</span> <span class="n">to_address</span><span class="p">(</span><span class="mh">0x100</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="mh">0x100</span><span class="p">)</span>
        <span class="n">pre</span><span class="p">[</span><span class="n">address</span><span class="p">]</span> <span class="o">=</span> <span class="n">Account</span><span class="p">(</span><span class="n">code</span><span class="o">=</span><span class="n">gas_code</span><span class="p">)</span>
        <span class="n">blocks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">Block</span><span class="p">(</span>
                <span class="n">txs</span><span class="o">=</span><span class="p">[</span>
                    <span class="n">template_tx</span><span class="o">.</span><span class="n">with_fields</span><span class="p">(</span>
                        <span class="n">ty</span><span class="o">=</span><span class="n">tx_type</span><span class="p">,</span>
                        <span class="n">nonce</span><span class="o">=</span><span class="n">i</span><span class="p">,</span>
                        <span class="n">to</span><span class="o">=</span><span class="n">address</span><span class="p">,</span>
                        <span class="n">gas_price</span><span class="o">=</span><span class="mi">10</span> <span class="k">if</span> <span class="n">tx_type</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
                        <span class="n">access_list</span><span class="o">=</span><span class="p">[]</span> <span class="k">if</span> <span class="n">tx_type</span> <span class="o">&gt;=</span> <span class="mi">2</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
                        <span class="n">max_priority_fee_per_gas</span><span class="o">=</span><span class="mi">10</span> <span class="k">if</span> <span class="n">tx_type</span> <span class="o">&gt;=</span> <span class="mi">2</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
                        <span class="n">blob_versioned_hashes</span><span class="o">=</span><span class="n">random_blob_hashes</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">TARGET_BLOB_PER_BLOCK</span><span class="p">]</span>
                        <span class="k">if</span> <span class="n">tx_type</span> <span class="o">&gt;=</span> <span class="mi">3</span>
                        <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="p">]</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">post</span><span class="p">[</span><span class="n">address</span><span class="p">]</span> <span class="o">=</span> <span class="n">Account</span><span class="p">(</span><span class="n">storage</span><span class="o">=</span><span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="n">BLOBHASH_GAS_COST</span><span class="p">})</span>
    <span class="n">blockchain_test</span><span class="p">(</span>
        <span class="n">pre</span><span class="o">=</span><span class="n">pre</span><span class="p">,</span>
        <span class="n">blocks</span><span class="o">=</span><span class="n">blocks</span><span class="p">,</span>
        <span class="n">post</span><span class="o">=</span><span class="n">post</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>






<div class="doc doc-object doc-function">



<h2 id="tests.eips.eip4844.test_blobhash_opcode.to_address" class="doc doc-heading">
<code class="highlight language-python"><span class="n">to_address</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span></code>

<a href="#tests.eips.eip4844.test_blobhash_opcode.to_address" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  
      <p>Converts an int or str into proper address 20-byte hex string.</p>

      <details class="quote">
        <summary>Source code in <code>src/ethereum_test_tools/common/helpers.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">to_address</span><span class="p">(</span><span class="nb">input</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts an int or str into proper address 20-byte hex string.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
        <span class="c1"># Convert to int</span>
        <span class="nb">input</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;0x&quot;</span> <span class="o">+</span> <span class="nb">input</span><span class="o">.</span><span class="n">to_bytes</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="s2">&quot;big&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span>
    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;invalid type to convert to account address&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>






<div class="doc doc-object doc-class">



<h2 id="tests.eips.eip4844.test_blobhash_opcode.CodeGasMeasure" class="doc doc-heading">
        <code>CodeGasMeasure</code>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#tests.eips.eip4844.test_blobhash_opcode.CodeGasMeasure" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><a class="autorefs autorefs-internal" title="ethereum_test_tools.code.code.Code" href="../../../../library/ethereum_test_tools/#ethereum_test_tools.Code">Code</a></code></p>

  
      <p>Helper class used to generate bytecode that measures gas usage of a
bytecode, taking into account and subtracting any extra overhead gas costs
required to execute.
By default, the result gas calculation is saved to storage key 0.</p>


        <details class="quote">
          <summary>Source code in <code>src/ethereum_test_tools/code/generators.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span><span class="p">(</span><span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">CodeGasMeasure</span><span class="p">(</span><span class="n">Code</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Helper class used to generate bytecode that measures gas usage of a</span>
<span class="sd">    bytecode, taking into account and subtracting any extra overhead gas costs</span>
<span class="sd">    required to execute.</span>
<span class="sd">    By default, the result gas calculation is saved to storage key 0.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">code</span><span class="p">:</span> <span class="nb">bytes</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Code</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Bytecode to be executed to measure the gas usage.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">overhead_cost</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Extra gas cost to be subtracted from extra operations.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">extra_stack_items</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Extra stack items that remain at the end of the execution.</span>
<span class="sd">    To be considered when subtracting the value of the previous GAS operation,</span>
<span class="sd">    and to be popped at the end of the execution.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">sstore_key</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Storage key to save the gas used.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">assemble</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Assemble the bytecode that measures gas usage.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">res</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">()</span>
        <span class="n">res</span> <span class="o">+=</span> <span class="nb">bytes</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="mh">0x5A</span><span class="p">,</span>  <span class="c1"># GAS</span>
            <span class="p">]</span>
        <span class="p">)</span>
        <span class="n">res</span> <span class="o">+=</span> <span class="n">code_to_bytes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">code</span><span class="p">)</span>  <span class="c1"># Execute code to measure its gas cost</span>
        <span class="n">res</span> <span class="o">+=</span> <span class="nb">bytes</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="mh">0x5A</span><span class="p">,</span>  <span class="c1"># GAS</span>
            <span class="p">]</span>
        <span class="p">)</span>
        <span class="c1"># We need to swap and pop for each extra stack item that remained from</span>
        <span class="c1"># the execution of the code</span>
        <span class="n">res</span> <span class="o">+=</span> <span class="p">(</span>
            <span class="nb">bytes</span><span class="p">(</span>
                <span class="p">[</span>
                    <span class="mh">0x90</span><span class="p">,</span>  <span class="c1"># SWAP1</span>
                    <span class="mh">0x50</span><span class="p">,</span>  <span class="c1"># POP</span>
                <span class="p">]</span>
            <span class="p">)</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">extra_stack_items</span>
        <span class="p">)</span>
        <span class="n">res</span> <span class="o">+=</span> <span class="nb">bytes</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="mh">0x90</span><span class="p">,</span>  <span class="c1"># SWAP1</span>
                <span class="mh">0x03</span><span class="p">,</span>  <span class="c1"># SUB</span>
                <span class="mh">0x60</span><span class="p">,</span>  <span class="c1"># PUSH1</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">overhead_cost</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span>  <span class="c1"># Overhead cost + GAS opcode price</span>
                <span class="mh">0x90</span><span class="p">,</span>  <span class="c1"># SWAP1</span>
                <span class="mh">0x03</span><span class="p">,</span>  <span class="c1"># SUB</span>
                <span class="mh">0x60</span><span class="p">,</span>  <span class="c1"># PUSH1</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sstore_key</span><span class="p">,</span>  <span class="c1"># -&gt; SSTORE key</span>
                <span class="mh">0x55</span><span class="p">,</span>  <span class="c1"># SSTORE</span>
                <span class="mh">0x00</span><span class="p">,</span>  <span class="c1"># STOP</span>
            <span class="p">]</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">res</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="ethereum_test_tools.code.generators.CodeGasMeasure.code" class="doc doc-heading">
<code class="highlight language-python"><span class="n">code</span><span class="p">:</span> <span class="nb">bytes</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Code</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ethereum_test_tools.code.generators.CodeGasMeasure.code" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Bytecode to be executed to measure the gas usage.</p>
  </div>

</div>






<div class="doc doc-object doc-attribute">



<h3 id="ethereum_test_tools.code.generators.CodeGasMeasure.overhead_cost" class="doc doc-heading">
<code class="highlight language-python"><span class="n">overhead_cost</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

<a href="#ethereum_test_tools.code.generators.CodeGasMeasure.overhead_cost" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Extra gas cost to be subtracted from extra operations.</p>
  </div>

</div>






<div class="doc doc-object doc-attribute">



<h3 id="ethereum_test_tools.code.generators.CodeGasMeasure.extra_stack_items" class="doc doc-heading">
<code class="highlight language-python"><span class="n">extra_stack_items</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

<a href="#ethereum_test_tools.code.generators.CodeGasMeasure.extra_stack_items" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Extra stack items that remain at the end of the execution.
To be considered when subtracting the value of the previous GAS operation,
and to be popped at the end of the execution.</p>
  </div>

</div>






<div class="doc doc-object doc-attribute">



<h3 id="ethereum_test_tools.code.generators.CodeGasMeasure.sstore_key" class="doc doc-heading">
<code class="highlight language-python"><span class="n">sstore_key</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

<a href="#ethereum_test_tools.code.generators.CodeGasMeasure.sstore_key" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Storage key to save the gas used.</p>
  </div>

</div>






<div class="doc doc-object doc-function">



<h3 id="ethereum_test_tools.code.generators.CodeGasMeasure.assemble" class="doc doc-heading">
<code class="highlight language-python"><span class="n">assemble</span><span class="p">()</span></code>

<a href="#ethereum_test_tools.code.generators.CodeGasMeasure.assemble" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Assemble the bytecode that measures gas usage.</p>

      <details class="quote">
        <summary>Source code in <code>src/ethereum_test_tools/code/generators.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">assemble</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Assemble the bytecode that measures gas usage.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">res</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">()</span>
    <span class="n">res</span> <span class="o">+=</span> <span class="nb">bytes</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="mh">0x5A</span><span class="p">,</span>  <span class="c1"># GAS</span>
        <span class="p">]</span>
    <span class="p">)</span>
    <span class="n">res</span> <span class="o">+=</span> <span class="n">code_to_bytes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">code</span><span class="p">)</span>  <span class="c1"># Execute code to measure its gas cost</span>
    <span class="n">res</span> <span class="o">+=</span> <span class="nb">bytes</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="mh">0x5A</span><span class="p">,</span>  <span class="c1"># GAS</span>
        <span class="p">]</span>
    <span class="p">)</span>
    <span class="c1"># We need to swap and pop for each extra stack item that remained from</span>
    <span class="c1"># the execution of the code</span>
    <span class="n">res</span> <span class="o">+=</span> <span class="p">(</span>
        <span class="nb">bytes</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="mh">0x90</span><span class="p">,</span>  <span class="c1"># SWAP1</span>
                <span class="mh">0x50</span><span class="p">,</span>  <span class="c1"># POP</span>
            <span class="p">]</span>
        <span class="p">)</span>
        <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">extra_stack_items</span>
    <span class="p">)</span>
    <span class="n">res</span> <span class="o">+=</span> <span class="nb">bytes</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="mh">0x90</span><span class="p">,</span>  <span class="c1"># SWAP1</span>
            <span class="mh">0x03</span><span class="p">,</span>  <span class="c1"># SUB</span>
            <span class="mh">0x60</span><span class="p">,</span>  <span class="c1"># PUSH1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">overhead_cost</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span>  <span class="c1"># Overhead cost + GAS opcode price</span>
            <span class="mh">0x90</span><span class="p">,</span>  <span class="c1"># SWAP1</span>
            <span class="mh">0x03</span><span class="p">,</span>  <span class="c1"># SUB</span>
            <span class="mh">0x60</span><span class="p">,</span>  <span class="c1"># PUSH1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sstore_key</span><span class="p">,</span>  <span class="c1"># -&gt; SSTORE key</span>
            <span class="mh">0x55</span><span class="p">,</span>  <span class="c1"># SSTORE</span>
            <span class="mh">0x00</span><span class="p">,</span>  <span class="c1"># STOP</span>
        <span class="p">]</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">res</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>




  </div>

  </div>

</div>






<div class="doc doc-object doc-function">



<h2 id="tests.eips.eip4844.test_blobhash_opcode.to_hash_bytes" class="doc doc-heading">
<code class="highlight language-python"><span class="n">to_hash_bytes</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span></code>

<a href="#tests.eips.eip4844.test_blobhash_opcode.to_hash_bytes" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  
      <p>Converts an int or str into proper 32-byte hash.</p>

      <details class="quote">
        <summary>Source code in <code>src/ethereum_test_tools/common/helpers.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">to_hash_bytes</span><span class="p">(</span><span class="nb">input</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts an int or str into proper 32-byte hash.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
        <span class="c1"># Convert to int</span>
        <span class="nb">input</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">input</span><span class="o">.</span><span class="n">to_bytes</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="s2">&quot;big&quot;</span><span class="p">)</span>
    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;invalid type to convert to hash&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>






<div class="doc doc-object doc-function">



<h2 id="tests.eips.eip4844.test_blobhash_opcode.test_blobhash_scenarios" class="doc doc-heading">
<code class="highlight language-python"><span class="n">test_blobhash_scenarios</span><span class="p">(</span><span class="n">pre</span><span class="p">,</span> <span class="n">template_tx</span><span class="p">,</span> <span class="n">blocks</span><span class="p">,</span> <span class="n">post</span><span class="p">,</span> <span class="n">scenario</span><span class="p">,</span> <span class="n">blockchain_test</span><span class="p">)</span></code>

<a href="#tests.eips.eip4844.test_blobhash_opcode.test_blobhash_scenarios" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  
      <p>Tests that the BLOBHASH opcode returns the correct versioned hash for
various valid indexes.</p>
<p>Covers various scenarios with random blob_versioned_hash values within
the valid range <code>[0, 2**256-1]</code>.</p>

      <details class="quote">
        <summary>Source code in <code>tests/eips/eip4844/test_blobhash_opcode.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">parametrize</span><span class="p">(</span>
    <span class="s2">&quot;scenario&quot;</span><span class="p">,</span>
    <span class="p">[</span>
        <span class="s2">&quot;single_valid&quot;</span><span class="p">,</span>
        <span class="s2">&quot;repeated_valid&quot;</span><span class="p">,</span>
        <span class="s2">&quot;valid_invalid&quot;</span><span class="p">,</span>
        <span class="s2">&quot;varied_valid&quot;</span><span class="p">,</span>
    <span class="p">],</span>
<span class="p">)</span>
<span class="k">def</span> <span class="nf">test_blobhash_scenarios</span><span class="p">(</span>
    <span class="n">pre</span><span class="p">,</span>
    <span class="n">template_tx</span><span class="p">,</span>
    <span class="n">blocks</span><span class="p">,</span>
    <span class="n">post</span><span class="p">,</span>
    <span class="n">scenario</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">blockchain_test</span><span class="p">:</span> <span class="n">BlockchainTestFiller</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Tests that the BLOBHASH opcode returns the correct versioned hash for</span>
<span class="sd">    various valid indexes.</span>

<span class="sd">    Covers various scenarios with random blob_versioned_hash values within</span>
<span class="sd">    the valid range `[0, 2**256-1]`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">TOTAL_BLOCKS</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="n">b_hashes_list</span> <span class="o">=</span> <span class="n">BlobhashScenario</span><span class="o">.</span><span class="n">create_blob_hashes_list</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="n">TOTAL_BLOCKS</span><span class="p">)</span>
    <span class="n">blobhash_calls</span> <span class="o">=</span> <span class="n">BlobhashScenario</span><span class="o">.</span><span class="n">generate_blobhash_bytecode</span><span class="p">(</span><span class="n">scenario</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">TOTAL_BLOCKS</span><span class="p">):</span>
        <span class="n">address</span> <span class="o">=</span> <span class="n">to_address</span><span class="p">(</span><span class="mh">0x100</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="mh">0x100</span><span class="p">)</span>
        <span class="n">pre</span><span class="p">[</span><span class="n">address</span><span class="p">]</span> <span class="o">=</span> <span class="n">Account</span><span class="p">(</span><span class="n">code</span><span class="o">=</span><span class="n">blobhash_calls</span><span class="p">)</span>
        <span class="n">blocks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">Block</span><span class="p">(</span>
                <span class="n">txs</span><span class="o">=</span><span class="p">[</span>
                    <span class="n">template_tx</span><span class="o">.</span><span class="n">with_fields</span><span class="p">(</span>
                        <span class="n">ty</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                        <span class="n">nonce</span><span class="o">=</span><span class="n">i</span><span class="p">,</span>
                        <span class="n">to</span><span class="o">=</span><span class="n">address</span><span class="p">,</span>
                        <span class="n">access_list</span><span class="o">=</span><span class="p">[],</span>
                        <span class="n">max_priority_fee_per_gas</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                        <span class="n">blob_versioned_hashes</span><span class="o">=</span><span class="n">b_hashes_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                    <span class="p">)</span>
                <span class="p">]</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">post</span><span class="p">[</span><span class="n">address</span><span class="p">]</span> <span class="o">=</span> <span class="n">Account</span><span class="p">(</span>
            <span class="n">storage</span><span class="o">=</span><span class="p">{</span><span class="n">index</span><span class="p">:</span> <span class="n">b_hashes_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">index</span><span class="p">]</span> <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">MAX_BLOB_PER_BLOCK</span><span class="p">)}</span>
        <span class="p">)</span>
    <span class="n">blockchain_test</span><span class="p">(</span>
        <span class="n">pre</span><span class="o">=</span><span class="n">pre</span><span class="p">,</span>
        <span class="n">blocks</span><span class="o">=</span><span class="n">blocks</span><span class="p">,</span>
        <span class="n">post</span><span class="o">=</span><span class="n">post</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>






<div class="doc doc-object doc-class">



<h2 id="tests.eips.eip4844.test_blobhash_opcode.Op" class="doc doc-heading">
        <code>Op</code>


<a href="#tests.eips.eip4844.test_blobhash_opcode.Op" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><a class="autorefs autorefs-internal" title="ethereum_test_tools.vm.opcode.Opcode" href="../../../../library/ethereum_test_tools/#ethereum_test_tools.Opcode">Opcode</a></code>, <code><span title="enum.Enum">Enum</span></code></p>

  
      <p>Enum containing all known opcodes.</p>
<p>Contains deprecated and not yet implemented opcodes.</p>
<p>This enum is !! NOT !! meant to be iterated over by the tests. Instead,
create a list with cherry-picked opcodes from this Enum within the test
if iteration is needed.</p>
<p>Do !! NOT !! remove or modify existing opcodes from this list.</p>


        <details class="quote">
          <summary>Source code in <code>src/ethereum_test_tools/vm/opcode.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Opcodes</span><span class="p">(</span><span class="n">Opcode</span><span class="p">,</span> <span class="n">Enum</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Enum containing all known opcodes.</span>

<span class="sd">    Contains deprecated and not yet implemented opcodes.</span>

<span class="sd">    This enum is !! NOT !! meant to be iterated over by the tests. Instead,</span>
<span class="sd">    create a list with cherry-picked opcodes from this Enum within the test</span>
<span class="sd">    if iteration is needed.</span>

<span class="sd">    Do !! NOT !! remove or modify existing opcodes from this list.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">STOP</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x00</span><span class="p">)</span>
    <span class="n">ADD</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x01</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">MUL</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x02</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">SUB</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x03</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">DIV</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x04</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">SDIV</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x05</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">MOD</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x06</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">SMOD</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x07</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ADDMOD</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x08</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">MULMOD</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x09</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">EXP</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x0A</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">SIGNEXTEND</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x0B</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">LT</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x10</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">GT</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x11</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">SLT</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x12</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">SGT</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x13</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">EQ</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x14</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ISZERO</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x15</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">AND</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x16</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">OR</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x17</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">XOR</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x18</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">NOT</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x19</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">BYTE</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x1A</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">SHL</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x1B</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">SHR</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x1C</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">SAR</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x1D</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">SHA3</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x20</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">ADDRESS</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x30</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">BALANCE</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x31</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ORIGIN</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x32</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">CALLER</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x33</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">CALLVALUE</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x34</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">CALLDATALOAD</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x35</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">CALLDATASIZE</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x36</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">CALLDATACOPY</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x37</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">CODESIZE</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x38</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">CODECOPY</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x39</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">GASPRICE</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x3A</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">EXTCODESIZE</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x3B</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">EXTCODECOPY</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x3C</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">RETURNDATASIZE</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x3D</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">RETURNDATACOPY</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x3E</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">EXTCODEHASH</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x3F</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">BLOCKHASH</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x40</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">COINBASE</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x41</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">TIMESTAMP</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x42</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">NUMBER</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x43</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">PREVRANDAO</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x44</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">GASLIMIT</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x45</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">CHAINID</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x46</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">SELFBALANCE</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x47</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">BASEFEE</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x48</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">BLOBHASH</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x49</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">POP</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x50</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">MLOAD</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x51</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">MSTORE</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x52</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">MSTORE8</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x53</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">SLOAD</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x54</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">SSTORE</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x55</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">JUMP</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x56</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">JUMPI</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x57</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">PC</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x58</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">MSIZE</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x59</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">GAS</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x5A</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">JUMPDEST</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x5B</span><span class="p">)</span>
    <span class="n">RJUMP</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x5C</span><span class="p">,</span> <span class="n">data_portion_length</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">RJUMPI</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x5D</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">data_portion_length</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">CALLF</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x5E</span><span class="p">,</span> <span class="n">data_portion_length</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">RETF</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x49</span><span class="p">)</span>

    <span class="n">PUSH0</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x5F</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">PUSH1</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x60</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">data_portion_length</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">PUSH2</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x61</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">data_portion_length</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">PUSH3</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x62</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">data_portion_length</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">PUSH4</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x63</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">data_portion_length</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">PUSH5</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x64</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">data_portion_length</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">PUSH6</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x65</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">data_portion_length</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
    <span class="n">PUSH7</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x66</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">data_portion_length</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
    <span class="n">PUSH8</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x67</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">data_portion_length</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">PUSH9</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x68</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">data_portion_length</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
    <span class="n">PUSH10</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x69</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">data_portion_length</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">PUSH11</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x6A</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">data_portion_length</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
    <span class="n">PUSH12</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x6B</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">data_portion_length</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">PUSH13</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x6C</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">data_portion_length</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
    <span class="n">PUSH14</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x6D</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">data_portion_length</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">PUSH15</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x6E</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">data_portion_length</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
    <span class="n">PUSH16</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x6F</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">data_portion_length</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">PUSH17</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x70</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">data_portion_length</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span>
    <span class="n">PUSH18</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x71</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">data_portion_length</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
    <span class="n">PUSH19</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x72</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">data_portion_length</span><span class="o">=</span><span class="mi">19</span><span class="p">)</span>
    <span class="n">PUSH20</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x73</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">data_portion_length</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">PUSH21</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x74</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">data_portion_length</span><span class="o">=</span><span class="mi">21</span><span class="p">)</span>
    <span class="n">PUSH22</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x75</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">data_portion_length</span><span class="o">=</span><span class="mi">22</span><span class="p">)</span>
    <span class="n">PUSH23</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x76</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">data_portion_length</span><span class="o">=</span><span class="mi">23</span><span class="p">)</span>
    <span class="n">PUSH24</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x77</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">data_portion_length</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
    <span class="n">PUSH25</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x78</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">data_portion_length</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
    <span class="n">PUSH26</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x79</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">data_portion_length</span><span class="o">=</span><span class="mi">26</span><span class="p">)</span>
    <span class="n">PUSH27</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x7A</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">data_portion_length</span><span class="o">=</span><span class="mi">27</span><span class="p">)</span>
    <span class="n">PUSH28</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x7B</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">data_portion_length</span><span class="o">=</span><span class="mi">28</span><span class="p">)</span>
    <span class="n">PUSH29</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x7C</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">data_portion_length</span><span class="o">=</span><span class="mi">29</span><span class="p">)</span>
    <span class="n">PUSH30</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x7D</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">data_portion_length</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
    <span class="n">PUSH31</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x7E</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">data_portion_length</span><span class="o">=</span><span class="mi">31</span><span class="p">)</span>
    <span class="n">PUSH32</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x7F</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">data_portion_length</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>

    <span class="n">DUP1</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x80</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">min_stack_height</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">DUP2</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x81</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">min_stack_height</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">DUP3</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x82</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">min_stack_height</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">DUP4</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x83</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">min_stack_height</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">DUP5</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x84</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">min_stack_height</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">DUP6</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x85</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">min_stack_height</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
    <span class="n">DUP7</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x86</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">min_stack_height</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
    <span class="n">DUP8</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x87</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">min_stack_height</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">DUP9</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x88</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">min_stack_height</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
    <span class="n">DUP10</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x89</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">min_stack_height</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">DUP11</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x8A</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">min_stack_height</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
    <span class="n">DUP12</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x8B</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">min_stack_height</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">DUP13</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x8C</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">min_stack_height</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
    <span class="n">DUP14</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x8D</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">min_stack_height</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">DUP15</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x8E</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">min_stack_height</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
    <span class="n">DUP16</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x8F</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">min_stack_height</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>

    <span class="n">SWAP1</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x90</span><span class="p">,</span> <span class="n">min_stack_height</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">SWAP2</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x91</span><span class="p">,</span> <span class="n">min_stack_height</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">SWAP3</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x92</span><span class="p">,</span> <span class="n">min_stack_height</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">SWAP4</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x93</span><span class="p">,</span> <span class="n">min_stack_height</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">SWAP5</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x94</span><span class="p">,</span> <span class="n">min_stack_height</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
    <span class="n">SWAP6</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x95</span><span class="p">,</span> <span class="n">min_stack_height</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
    <span class="n">SWAP7</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x96</span><span class="p">,</span> <span class="n">min_stack_height</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">SWAP8</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x97</span><span class="p">,</span> <span class="n">min_stack_height</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
    <span class="n">SWAP9</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x98</span><span class="p">,</span> <span class="n">min_stack_height</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">SWAP10</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x99</span><span class="p">,</span> <span class="n">min_stack_height</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
    <span class="n">SWAP11</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x9A</span><span class="p">,</span> <span class="n">min_stack_height</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">SWAP12</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x9B</span><span class="p">,</span> <span class="n">min_stack_height</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
    <span class="n">SWAP13</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x9C</span><span class="p">,</span> <span class="n">min_stack_height</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">SWAP14</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x9D</span><span class="p">,</span> <span class="n">min_stack_height</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
    <span class="n">SWAP15</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x9E</span><span class="p">,</span> <span class="n">min_stack_height</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">SWAP16</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x9F</span><span class="p">,</span> <span class="n">min_stack_height</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span>

    <span class="n">LOG0</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0xA0</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">LOG1</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0xA1</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">LOG2</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0xA2</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">LOG3</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0xA3</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">LOG4</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0xA4</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>

    <span class="n">TLOAD</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0xB3</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">TSTORE</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0xB4</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="n">CREATE</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0xF0</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">CALL</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0xF1</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">CALLCODE</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0xF2</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">RETURN</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0xF3</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">DELEGATECALL</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0xF4</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">CREATE2</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0xF5</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">STATICCALL</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0xFA</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">REVERT</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0xFD</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">INVALID</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0xFE</span><span class="p">)</span>

    <span class="n">SELFDESTRUCT</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0xFF</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">SENDALL</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0xFF</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">





  </div>

  </div>

</div>






<div class="doc doc-object doc-function">



<h2 id="tests.eips.eip4844.test_blobhash_opcode.test_blobhash_invalid_blob_index" class="doc doc-heading">
<code class="highlight language-python"><span class="n">test_blobhash_invalid_blob_index</span><span class="p">(</span><span class="n">pre</span><span class="p">,</span> <span class="n">template_tx</span><span class="p">,</span> <span class="n">blocks</span><span class="p">,</span> <span class="n">post</span><span class="p">,</span> <span class="n">blockchain_test</span><span class="p">,</span> <span class="n">scenario</span><span class="p">)</span></code>

<a href="#tests.eips.eip4844.test_blobhash_opcode.test_blobhash_invalid_blob_index" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  
      <p>Tests that the BLOBHASH opcode returns a zeroed <code>bytes32</code> value for invalid
indexes.</p>
<p>Includes cases where the index is negative (<code>index &lt; 0</code>) or
exceeds the maximum number of <code>blob_versioned_hash</code> values stored:
(<code>index &gt;= len(tx.message.blob_versioned_hashes)</code>).</p>
<p>It confirms that the returned value is a zeroed `bytes32 for each case.</p>

      <details class="quote">
        <summary>Source code in <code>tests/eips/eip4844/test_blobhash_opcode.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">parametrize</span><span class="p">(</span>
    <span class="s2">&quot;scenario&quot;</span><span class="p">,</span>
    <span class="p">[</span>
        <span class="s2">&quot;invalid_calls&quot;</span><span class="p">,</span>
    <span class="p">],</span>
<span class="p">)</span>
<span class="k">def</span> <span class="nf">test_blobhash_invalid_blob_index</span><span class="p">(</span>
    <span class="n">pre</span><span class="p">,</span>
    <span class="n">template_tx</span><span class="p">,</span>
    <span class="n">blocks</span><span class="p">,</span>
    <span class="n">post</span><span class="p">,</span>
    <span class="n">blockchain_test</span><span class="p">:</span> <span class="n">BlockchainTestFiller</span><span class="p">,</span>
    <span class="n">scenario</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Tests that the BLOBHASH opcode returns a zeroed `bytes32` value for invalid</span>
<span class="sd">    indexes.</span>

<span class="sd">    Includes cases where the index is negative (`index &lt; 0`) or</span>
<span class="sd">    exceeds the maximum number of `blob_versioned_hash` values stored:</span>
<span class="sd">    (`index &gt;= len(tx.message.blob_versioned_hashes)`).</span>

<span class="sd">    It confirms that the returned value is a zeroed `bytes32 for each case.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">TOTAL_BLOCKS</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="n">blobhash_calls</span> <span class="o">=</span> <span class="n">BlobhashScenario</span><span class="o">.</span><span class="n">generate_blobhash_bytecode</span><span class="p">(</span><span class="n">scenario</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">TOTAL_BLOCKS</span><span class="p">):</span>
        <span class="n">address</span> <span class="o">=</span> <span class="n">to_address</span><span class="p">(</span><span class="mh">0x100</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="mh">0x100</span><span class="p">)</span>
        <span class="n">pre</span><span class="p">[</span><span class="n">address</span><span class="p">]</span> <span class="o">=</span> <span class="n">Account</span><span class="p">(</span><span class="n">code</span><span class="o">=</span><span class="n">blobhash_calls</span><span class="p">)</span>
        <span class="n">blob_per_block</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span> <span class="o">%</span> <span class="n">MAX_BLOB_PER_BLOCK</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">blobs</span> <span class="o">=</span> <span class="p">[</span><span class="n">random_blob_hashes</span><span class="p">[</span><span class="n">blob</span><span class="p">]</span> <span class="k">for</span> <span class="n">blob</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">blob_per_block</span><span class="p">)]</span>
        <span class="n">blocks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">Block</span><span class="p">(</span>
                <span class="n">txs</span><span class="o">=</span><span class="p">[</span>
                    <span class="n">template_tx</span><span class="o">.</span><span class="n">with_fields</span><span class="p">(</span>
                        <span class="n">ty</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                        <span class="n">nonce</span><span class="o">=</span><span class="n">i</span><span class="p">,</span>
                        <span class="n">to</span><span class="o">=</span><span class="n">address</span><span class="p">,</span>
                        <span class="n">access_list</span><span class="o">=</span><span class="p">[],</span>
                        <span class="n">max_priority_fee_per_gas</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                        <span class="n">blob_versioned_hashes</span><span class="o">=</span><span class="n">blobs</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="p">]</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">post</span><span class="p">[</span><span class="n">address</span><span class="p">]</span> <span class="o">=</span> <span class="n">Account</span><span class="p">(</span>
            <span class="n">storage</span><span class="o">=</span><span class="p">{</span>
                <span class="n">index</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span> <span class="k">if</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">index</span> <span class="o">&gt;=</span> <span class="n">blob_per_block</span> <span class="k">else</span> <span class="n">blobs</span><span class="p">[</span><span class="n">index</span><span class="p">])</span>
                <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span>
                    <span class="o">-</span><span class="n">TOTAL_BLOCKS</span><span class="p">,</span>
                    <span class="n">blob_per_block</span> <span class="o">+</span> <span class="p">(</span><span class="n">TOTAL_BLOCKS</span> <span class="o">-</span> <span class="p">(</span><span class="n">i</span> <span class="o">%</span> <span class="n">MAX_BLOB_PER_BLOCK</span><span class="p">)),</span>
                <span class="p">)</span>
            <span class="p">}</span>
        <span class="p">)</span>
    <span class="n">blockchain_test</span><span class="p">(</span>
        <span class="n">pre</span><span class="o">=</span><span class="n">pre</span><span class="p">,</span>
        <span class="n">blocks</span><span class="o">=</span><span class="n">blocks</span><span class="p">,</span>
        <span class="n">post</span><span class="o">=</span><span class="n">post</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>






<div class="doc doc-object doc-function">



<h2 id="tests.eips.eip4844.test_blobhash_opcode.test_blobhash_multiple_txs_in_block" class="doc doc-heading">
<code class="highlight language-python"><span class="n">test_blobhash_multiple_txs_in_block</span><span class="p">(</span><span class="n">pre</span><span class="p">,</span> <span class="n">blob_tx</span><span class="p">,</span> <span class="n">post</span><span class="p">,</span> <span class="n">blockchain_test</span><span class="p">)</span></code>

<a href="#tests.eips.eip4844.test_blobhash_opcode.test_blobhash_multiple_txs_in_block" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  
      <p>Tests that the BLOBHASH opcode returns the appropriate values when there
is more than 1 blob tx type within a block (for tx types 2 and 3).</p>
<p>Scenarios involve tx type 3 followed by tx type 2 running the same code
within a block, including the opposite.</p>

      <details class="quote">
        <summary>Source code in <code>tests/eips/eip4844/test_blobhash_opcode.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">test_blobhash_multiple_txs_in_block</span><span class="p">(</span>
    <span class="n">pre</span><span class="p">,</span>
    <span class="n">blob_tx</span><span class="p">,</span>
    <span class="n">post</span><span class="p">,</span>
    <span class="n">blockchain_test</span><span class="p">:</span> <span class="n">BlockchainTestFiller</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Tests that the BLOBHASH opcode returns the appropriate values when there</span>
<span class="sd">    is more than 1 blob tx type within a block (for tx types 2 and 3).</span>

<span class="sd">    Scenarios involve tx type 3 followed by tx type 2 running the same code</span>
<span class="sd">    within a block, including the opposite.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">blobhash_bytecode</span> <span class="o">=</span> <span class="n">BlobhashScenario</span><span class="o">.</span><span class="n">generate_blobhash_bytecode</span><span class="p">(</span><span class="s2">&quot;single_valid&quot;</span><span class="p">)</span>
    <span class="n">pre</span> <span class="o">=</span> <span class="p">{</span>
        <span class="o">**</span><span class="n">pre</span><span class="p">,</span>
        <span class="o">**</span><span class="p">{</span>
            <span class="n">to_address</span><span class="p">(</span><span class="n">address</span><span class="p">):</span> <span class="n">Account</span><span class="p">(</span><span class="n">code</span><span class="o">=</span><span class="n">blobhash_bytecode</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">address</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mh">0x100</span><span class="p">,</span> <span class="mh">0x500</span><span class="p">,</span> <span class="mh">0x100</span><span class="p">)</span>
        <span class="p">},</span>
    <span class="p">}</span>
    <span class="n">blocks</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">Block</span><span class="p">(</span>
            <span class="n">txs</span><span class="o">=</span><span class="p">[</span>
                <span class="n">blob_tx</span><span class="p">(</span><span class="n">address</span><span class="o">=</span><span class="n">to_address</span><span class="p">(</span><span class="mh">0x100</span><span class="p">),</span> <span class="nb">type</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">nonce</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
                <span class="n">blob_tx</span><span class="p">(</span><span class="n">address</span><span class="o">=</span><span class="n">to_address</span><span class="p">(</span><span class="mh">0x100</span><span class="p">),</span> <span class="nb">type</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">nonce</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
            <span class="p">]</span>
        <span class="p">),</span>
        <span class="n">Block</span><span class="p">(</span>
            <span class="n">txs</span><span class="o">=</span><span class="p">[</span>
                <span class="n">blob_tx</span><span class="p">(</span><span class="n">address</span><span class="o">=</span><span class="n">to_address</span><span class="p">(</span><span class="mh">0x200</span><span class="p">),</span> <span class="nb">type</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">nonce</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span>
                <span class="n">blob_tx</span><span class="p">(</span><span class="n">address</span><span class="o">=</span><span class="n">to_address</span><span class="p">(</span><span class="mh">0x200</span><span class="p">),</span> <span class="nb">type</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">nonce</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span>
            <span class="p">]</span>
        <span class="p">),</span>
        <span class="n">Block</span><span class="p">(</span>
            <span class="n">txs</span><span class="o">=</span><span class="p">[</span>
                <span class="n">blob_tx</span><span class="p">(</span><span class="n">address</span><span class="o">=</span><span class="n">to_address</span><span class="p">(</span><span class="mh">0x300</span><span class="p">),</span> <span class="nb">type</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">nonce</span><span class="o">=</span><span class="mi">4</span><span class="p">),</span>
                <span class="n">blob_tx</span><span class="p">(</span><span class="n">address</span><span class="o">=</span><span class="n">to_address</span><span class="p">(</span><span class="mh">0x400</span><span class="p">),</span> <span class="nb">type</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">nonce</span><span class="o">=</span><span class="mi">5</span><span class="p">),</span>
            <span class="p">],</span>
        <span class="p">),</span>
    <span class="p">]</span>
    <span class="n">post</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">to_address</span><span class="p">(</span><span class="n">address</span><span class="p">):</span> <span class="n">Account</span><span class="p">(</span>
            <span class="n">storage</span><span class="o">=</span><span class="p">{</span><span class="n">i</span><span class="p">:</span> <span class="n">random_blob_hashes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">MAX_BLOB_PER_BLOCK</span><span class="p">)}</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">address</span> <span class="ow">in</span> <span class="p">(</span><span class="mh">0x200</span><span class="p">,</span> <span class="mh">0x400</span><span class="p">)</span>
        <span class="k">else</span> <span class="n">Account</span><span class="p">(</span><span class="n">storage</span><span class="o">=</span><span class="p">{</span><span class="n">i</span><span class="p">:</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">MAX_BLOB_PER_BLOCK</span><span class="p">)})</span>
        <span class="k">for</span> <span class="n">address</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mh">0x100</span><span class="p">,</span> <span class="mh">0x500</span><span class="p">,</span> <span class="mh">0x100</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="n">blockchain_test</span><span class="p">(</span>
        <span class="n">pre</span><span class="o">=</span><span class="n">pre</span><span class="p">,</span>
        <span class="n">blocks</span><span class="o">=</span><span class="n">blocks</span><span class="p">,</span>
        <span class="n">post</span><span class="o">=</span><span class="n">post</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>






<div class="doc doc-object doc-class">



<h2 id="tests.eips.eip4844.test_blobhash_opcode.BlobhashScenario" class="doc doc-heading">
        <code>BlobhashScenario</code>


<a href="#tests.eips.eip4844.test_blobhash_opcode.BlobhashScenario" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">

  
      <p>A utility class for generating blobhash calls.</p>


        <details class="quote">
          <summary>Source code in <code>tests/eips/eip4844/util_blobhash.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">BlobhashScenario</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A utility class for generating blobhash calls.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">create_blob_hashes_list</span><span class="p">(</span><span class="n">length</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">bytes</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a list of MAX_BLOB_PER_BLOCK blob hashes</span>
<span class="sd">        using `random_blob_hashes`.</span>

<span class="sd">        Cycle over random_blob_hashes to get a large list of</span>
<span class="sd">        length: MAX_BLOB_PER_BLOCK * length</span>
<span class="sd">        -&gt; [0x01, 0x02, 0x03, 0x04, ..., 0x0A, 0x0B, 0x0C, 0x0D]</span>

<span class="sd">        Then split list into smaller chunks of MAX_BLOB_PER_BLOCK</span>
<span class="sd">        -&gt; [[0x01, 0x02, 0x03, 0x04], ..., [0x0a, 0x0b, 0x0c, 0x0d]]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">b_hashes</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">random_blob_hashes</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">random_blob_hashes</span><span class="p">)]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">MAX_BLOB_PER_BLOCK</span> <span class="o">*</span> <span class="n">length</span><span class="p">)</span>
        <span class="p">]</span>
        <span class="k">return</span> <span class="p">[</span>
            <span class="n">b_hashes</span><span class="p">[</span><span class="n">i</span> <span class="p">:</span> <span class="n">i</span> <span class="o">+</span> <span class="n">MAX_BLOB_PER_BLOCK</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">b_hashes</span><span class="p">),</span> <span class="n">MAX_BLOB_PER_BLOCK</span><span class="p">)</span>
        <span class="p">]</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">blobhash_sstore</span><span class="p">(</span><span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns an BLOBHASH sstore to the given index.</span>

<span class="sd">        If the index is out of the valid bounds, 0x01 is written</span>
<span class="sd">        in storage, as we later check it is overwritten by</span>
<span class="sd">        the BLOBHASH sstore.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">invalidity_check</span> <span class="o">=</span> <span class="n">Op</span><span class="o">.</span><span class="n">SSTORE</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">index</span> <span class="o">&gt;=</span> <span class="n">MAX_BLOB_PER_BLOCK</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">invalidity_check</span> <span class="o">+</span> <span class="n">Op</span><span class="o">.</span><span class="n">SSTORE</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">Op</span><span class="o">.</span><span class="n">BLOBHASH</span><span class="p">(</span><span class="n">index</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">Op</span><span class="o">.</span><span class="n">SSTORE</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">Op</span><span class="o">.</span><span class="n">BLOBHASH</span><span class="p">(</span><span class="n">index</span><span class="p">))</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">generate_blobhash_bytecode</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">scenario_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns BLOBHASH bytecode for the given scenario.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">scenarios</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;single_valid&quot;</span><span class="p">:</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">blobhash_sstore</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">MAX_BLOB_PER_BLOCK</span><span class="p">)),</span>
            <span class="s2">&quot;repeated_valid&quot;</span><span class="p">:</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                <span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">blobhash_sstore</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">MAX_BLOB_PER_BLOCK</span><span class="p">)</span>
            <span class="p">),</span>
            <span class="s2">&quot;valid_invalid&quot;</span><span class="p">:</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                <span class="bp">cls</span><span class="o">.</span><span class="n">blobhash_sstore</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                <span class="o">+</span> <span class="bp">cls</span><span class="o">.</span><span class="n">blobhash_sstore</span><span class="p">(</span><span class="n">MAX_BLOB_PER_BLOCK</span><span class="p">)</span>
                <span class="o">+</span> <span class="bp">cls</span><span class="o">.</span><span class="n">blobhash_sstore</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">MAX_BLOB_PER_BLOCK</span><span class="p">)</span>
            <span class="p">),</span>
            <span class="s2">&quot;varied_valid&quot;</span><span class="p">:</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                <span class="bp">cls</span><span class="o">.</span><span class="n">blobhash_sstore</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="bp">cls</span><span class="o">.</span><span class="n">blobhash_sstore</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="bp">cls</span><span class="o">.</span><span class="n">blobhash_sstore</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">MAX_BLOB_PER_BLOCK</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
            <span class="p">),</span>
            <span class="s2">&quot;invalid_calls&quot;</span><span class="p">:</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                <span class="bp">cls</span><span class="o">.</span><span class="n">blobhash_sstore</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="n">MAX_BLOB_PER_BLOCK</span> <span class="o">+</span> <span class="mi">5</span><span class="p">)</span>
            <span class="p">),</span>
        <span class="p">}</span>
        <span class="n">scenario</span> <span class="o">=</span> <span class="n">scenarios</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">scenario_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">scenario</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid scenario: </span><span class="si">{</span><span class="n">scenario_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">scenario</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-function">



<h3 id="tests.eips.eip4844.util_blobhash.BlobhashScenario.create_blob_hashes_list" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_blob_hashes_list</span><span class="p">(</span><span class="n">length</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#tests.eips.eip4844.util_blobhash.BlobhashScenario.create_blob_hashes_list" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Creates a list of MAX_BLOB_PER_BLOCK blob hashes
using <code>random_blob_hashes</code>.</p>
<p>Cycle over random_blob_hashes to get a large list of
length: MAX_BLOB_PER_BLOCK * length
-&gt; [0x01, 0x02, 0x03, 0x04, ..., 0x0A, 0x0B, 0x0C, 0x0D]</p>
<p>Then split list into smaller chunks of MAX_BLOB_PER_BLOCK
-&gt; [[0x01, 0x02, 0x03, 0x04], ..., [0x0a, 0x0b, 0x0c, 0x0d]]</p>

      <details class="quote">
        <summary>Source code in <code>tests/eips/eip4844/util_blobhash.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">create_blob_hashes_list</span><span class="p">(</span><span class="n">length</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">bytes</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a list of MAX_BLOB_PER_BLOCK blob hashes</span>
<span class="sd">    using `random_blob_hashes`.</span>

<span class="sd">    Cycle over random_blob_hashes to get a large list of</span>
<span class="sd">    length: MAX_BLOB_PER_BLOCK * length</span>
<span class="sd">    -&gt; [0x01, 0x02, 0x03, 0x04, ..., 0x0A, 0x0B, 0x0C, 0x0D]</span>

<span class="sd">    Then split list into smaller chunks of MAX_BLOB_PER_BLOCK</span>
<span class="sd">    -&gt; [[0x01, 0x02, 0x03, 0x04], ..., [0x0a, 0x0b, 0x0c, 0x0d]]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">b_hashes</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">random_blob_hashes</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">random_blob_hashes</span><span class="p">)]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">MAX_BLOB_PER_BLOCK</span> <span class="o">*</span> <span class="n">length</span><span class="p">)</span>
    <span class="p">]</span>
    <span class="k">return</span> <span class="p">[</span>
        <span class="n">b_hashes</span><span class="p">[</span><span class="n">i</span> <span class="p">:</span> <span class="n">i</span> <span class="o">+</span> <span class="n">MAX_BLOB_PER_BLOCK</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">b_hashes</span><span class="p">),</span> <span class="n">MAX_BLOB_PER_BLOCK</span><span class="p">)</span>
    <span class="p">]</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>






<div class="doc doc-object doc-function">



<h3 id="tests.eips.eip4844.util_blobhash.BlobhashScenario.blobhash_sstore" class="doc doc-heading">
<code class="highlight language-python"><span class="n">blobhash_sstore</span><span class="p">(</span><span class="n">index</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#tests.eips.eip4844.util_blobhash.BlobhashScenario.blobhash_sstore" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Returns an BLOBHASH sstore to the given index.</p>
<p>If the index is out of the valid bounds, 0x01 is written
in storage, as we later check it is overwritten by
the BLOBHASH sstore.</p>

      <details class="quote">
        <summary>Source code in <code>tests/eips/eip4844/util_blobhash.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">blobhash_sstore</span><span class="p">(</span><span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns an BLOBHASH sstore to the given index.</span>

<span class="sd">    If the index is out of the valid bounds, 0x01 is written</span>
<span class="sd">    in storage, as we later check it is overwritten by</span>
<span class="sd">    the BLOBHASH sstore.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">invalidity_check</span> <span class="o">=</span> <span class="n">Op</span><span class="o">.</span><span class="n">SSTORE</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">index</span> <span class="o">&gt;=</span> <span class="n">MAX_BLOB_PER_BLOCK</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">invalidity_check</span> <span class="o">+</span> <span class="n">Op</span><span class="o">.</span><span class="n">SSTORE</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">Op</span><span class="o">.</span><span class="n">BLOBHASH</span><span class="p">(</span><span class="n">index</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">Op</span><span class="o">.</span><span class="n">SSTORE</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">Op</span><span class="o">.</span><span class="n">BLOBHASH</span><span class="p">(</span><span class="n">index</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>






<div class="doc doc-object doc-function">



<h3 id="tests.eips.eip4844.util_blobhash.BlobhashScenario.generate_blobhash_bytecode" class="doc doc-heading">
<code class="highlight language-python"><span class="n">generate_blobhash_bytecode</span><span class="p">(</span><span class="n">scenario_name</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#tests.eips.eip4844.util_blobhash.BlobhashScenario.generate_blobhash_bytecode" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Returns BLOBHASH bytecode for the given scenario.</p>

      <details class="quote">
        <summary>Source code in <code>tests/eips/eip4844/util_blobhash.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">generate_blobhash_bytecode</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">scenario_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns BLOBHASH bytecode for the given scenario.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">scenarios</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;single_valid&quot;</span><span class="p">:</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">blobhash_sstore</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">MAX_BLOB_PER_BLOCK</span><span class="p">)),</span>
        <span class="s2">&quot;repeated_valid&quot;</span><span class="p">:</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">blobhash_sstore</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">MAX_BLOB_PER_BLOCK</span><span class="p">)</span>
        <span class="p">),</span>
        <span class="s2">&quot;valid_invalid&quot;</span><span class="p">:</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">blobhash_sstore</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="o">+</span> <span class="bp">cls</span><span class="o">.</span><span class="n">blobhash_sstore</span><span class="p">(</span><span class="n">MAX_BLOB_PER_BLOCK</span><span class="p">)</span>
            <span class="o">+</span> <span class="bp">cls</span><span class="o">.</span><span class="n">blobhash_sstore</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">MAX_BLOB_PER_BLOCK</span><span class="p">)</span>
        <span class="p">),</span>
        <span class="s2">&quot;varied_valid&quot;</span><span class="p">:</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">blobhash_sstore</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="bp">cls</span><span class="o">.</span><span class="n">blobhash_sstore</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="bp">cls</span><span class="o">.</span><span class="n">blobhash_sstore</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">MAX_BLOB_PER_BLOCK</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="p">),</span>
        <span class="s2">&quot;invalid_calls&quot;</span><span class="p">:</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">blobhash_sstore</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="n">MAX_BLOB_PER_BLOCK</span> <span class="o">+</span> <span class="mi">5</span><span class="p">)</span>
        <span class="p">),</span>
    <span class="p">}</span>
    <span class="n">scenario</span> <span class="o">=</span> <span class="n">scenarios</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">scenario_name</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">scenario</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid scenario: </span><span class="si">{</span><span class="n">scenario_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">scenario</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>




  </div>

  </div>

</div>






<div class="doc doc-object doc-class">



<h2 id="tests.eips.eip4844.test_blobhash_opcode.Account" class="doc doc-heading">
        <code>Account</code>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#tests.eips.eip4844.test_blobhash_opcode.Account" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">

  
      <p>State associated with an address.</p>


        <details class="quote">
          <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span><span class="p">(</span><span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">Account</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    State associated with an address.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">nonce</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The scalar value equal to a) the number of transactions sent by</span>
<span class="sd">    an Externally Owned Account, b) the amount of contracts created by a</span>
<span class="sd">    contract.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">balance</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The amount of Wei (10&lt;sup&gt;-18&lt;/sup&gt; Eth) the account has.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">code</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">bytes</span> <span class="o">|</span> <span class="n">Code</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Bytecode contained by the account.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">storage</span><span class="p">:</span> <span class="n">Storage</span> <span class="o">|</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">bytes</span><span class="p">,</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">bytes</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Storage within a contract.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">NONEXISTENT</span><span class="p">:</span> <span class="n">ClassVar</span><span class="p">[</span><span class="nb">object</span><span class="p">]</span> <span class="o">=</span> <span class="nb">object</span><span class="p">()</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sentinel object used to specify when an account should not exist in the</span>
<span class="sd">    state.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">class</span> <span class="nc">NonceMismatch</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Test expected a certain nonce value for an account but a different</span>
<span class="sd">        value was found.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">address</span><span class="p">:</span> <span class="nb">str</span>
        <span class="n">want</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span>
        <span class="n">got</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span>

        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">address</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">want</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="n">got</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">address</span> <span class="o">=</span> <span class="n">address</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">want</span> <span class="o">=</span> <span class="n">want</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">got</span> <span class="o">=</span> <span class="n">got</span>

        <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;Print exception string&quot;&quot;&quot;</span>
            <span class="k">return</span> <span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;unexpected nonce for account </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">address</span><span class="si">}</span><span class="s2">: &quot;</span>
                <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;want </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">want</span><span class="si">}</span><span class="s2">, got </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">got</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

    <span class="k">class</span> <span class="nc">BalanceMismatch</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Test expected a certain balance for an account but a different</span>
<span class="sd">        value was found.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">address</span><span class="p">:</span> <span class="nb">str</span>
        <span class="n">want</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span>
        <span class="n">got</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span>

        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">address</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">want</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="n">got</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">address</span> <span class="o">=</span> <span class="n">address</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">want</span> <span class="o">=</span> <span class="n">want</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">got</span> <span class="o">=</span> <span class="n">got</span>

        <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;Print exception string&quot;&quot;&quot;</span>
            <span class="k">return</span> <span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;unexpected balance for account </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">address</span><span class="si">}</span><span class="s2">: &quot;</span>
                <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;want </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">want</span><span class="si">}</span><span class="s2">, got </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">got</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

    <span class="k">class</span> <span class="nc">CodeMismatch</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Test expected a certain bytecode for an account but a different</span>
<span class="sd">        one was found.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">address</span><span class="p">:</span> <span class="nb">str</span>
        <span class="n">want</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span>
        <span class="n">got</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span>

        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">address</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">want</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="n">got</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">address</span> <span class="o">=</span> <span class="n">address</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">want</span> <span class="o">=</span> <span class="n">want</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">got</span> <span class="o">=</span> <span class="n">got</span>

        <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;Print exception string&quot;&quot;&quot;</span>
            <span class="k">return</span> <span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;unexpected code for account </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">address</span><span class="si">}</span><span class="s2">: &quot;</span>
                <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;want </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">want</span><span class="si">}</span><span class="s2">, got </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">got</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Automatically init account members&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">storage</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">storage</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">dict</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">storage</span> <span class="o">=</span> <span class="n">Storage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">storage</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">check_alloc</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="s2">&quot;Account&quot;</span><span class="p">,</span> <span class="n">address</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">alloc</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks the returned alloc against an expected account in post state.</span>
<span class="sd">        Raises exception on failure.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nonce</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">actual_nonce</span> <span class="o">=</span> <span class="n">int_or_none</span><span class="p">(</span><span class="n">alloc</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;nonce&quot;</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nonce</span> <span class="o">!=</span> <span class="n">actual_nonce</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">Account</span><span class="o">.</span><span class="n">NonceMismatch</span><span class="p">(</span>
                    <span class="n">address</span><span class="o">=</span><span class="n">address</span><span class="p">,</span>
                    <span class="n">want</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nonce</span><span class="p">,</span>
                    <span class="n">got</span><span class="o">=</span><span class="n">actual_nonce</span><span class="p">,</span>
                <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">balance</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">actual_balance</span> <span class="o">=</span> <span class="n">int_or_none</span><span class="p">(</span><span class="n">alloc</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;balance&quot;</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">balance</span> <span class="o">!=</span> <span class="n">actual_balance</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">Account</span><span class="o">.</span><span class="n">BalanceMismatch</span><span class="p">(</span>
                    <span class="n">address</span><span class="o">=</span><span class="n">address</span><span class="p">,</span>
                    <span class="n">want</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">balance</span><span class="p">,</span>
                    <span class="n">got</span><span class="o">=</span><span class="n">actual_balance</span><span class="p">,</span>
                <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">code</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">expected_code</span> <span class="o">=</span> <span class="n">code_to_hex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">code</span><span class="p">)</span>
            <span class="n">actual_code</span> <span class="o">=</span> <span class="n">str_or_none</span><span class="p">(</span><span class="n">alloc</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;code&quot;</span><span class="p">),</span> <span class="s2">&quot;0x&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">expected_code</span> <span class="o">!=</span> <span class="n">actual_code</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">Account</span><span class="o">.</span><span class="n">CodeMismatch</span><span class="p">(</span>
                    <span class="n">address</span><span class="o">=</span><span class="n">address</span><span class="p">,</span>
                    <span class="n">want</span><span class="o">=</span><span class="n">expected_code</span><span class="p">,</span>
                    <span class="n">got</span><span class="o">=</span><span class="n">actual_code</span><span class="p">,</span>
                <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">storage</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">expected_storage</span> <span class="o">=</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">storage</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">storage</span><span class="p">,</span> <span class="n">Storage</span><span class="p">)</span> <span class="k">else</span> <span class="n">Storage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">storage</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="n">actual_storage</span> <span class="o">=</span> <span class="n">Storage</span><span class="p">(</span><span class="n">alloc</span><span class="p">[</span><span class="s2">&quot;storage&quot;</span><span class="p">])</span> <span class="k">if</span> <span class="s2">&quot;storage&quot;</span> <span class="ow">in</span> <span class="n">alloc</span> <span class="k">else</span> <span class="n">Storage</span><span class="p">({})</span>
            <span class="n">expected_storage</span><span class="o">.</span><span class="n">must_be_equal</span><span class="p">(</span><span class="n">actual_storage</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">with_code</span><span class="p">(</span><span class="bp">cls</span><span class="p">:</span> <span class="n">Type</span><span class="p">,</span> <span class="n">code</span><span class="p">:</span> <span class="nb">bytes</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Code</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Account&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create account with provided `code` and nonce of `1`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Account</span><span class="p">(</span><span class="n">nonce</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">code</span><span class="o">=</span><span class="n">code</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="ethereum_test_tools.common.types.Account.nonce" class="doc doc-heading">
<code class="highlight language-python"><span class="n">nonce</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

<a href="#ethereum_test_tools.common.types.Account.nonce" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>The scalar value equal to a) the number of transactions sent by
an Externally Owned Account, b) the amount of contracts created by a
contract.</p>
  </div>

</div>






<div class="doc doc-object doc-attribute">



<h3 id="ethereum_test_tools.common.types.Account.balance" class="doc doc-heading">
<code class="highlight language-python"><span class="n">balance</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

<a href="#ethereum_test_tools.common.types.Account.balance" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>The amount of Wei (10<sup>-18</sup> Eth) the account has.</p>
  </div>

</div>






<div class="doc doc-object doc-attribute">



<h3 id="ethereum_test_tools.common.types.Account.code" class="doc doc-heading">
<code class="highlight language-python"><span class="n">code</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">bytes</span> <span class="o">|</span> <span class="n">Code</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

<a href="#ethereum_test_tools.common.types.Account.code" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Bytecode contained by the account.</p>
  </div>

</div>






<div class="doc doc-object doc-attribute">



<h3 id="ethereum_test_tools.common.types.Account.storage" class="doc doc-heading">
<code class="highlight language-python"><span class="n">storage</span><span class="p">:</span> <span class="n">Storage</span> <span class="o">|</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">bytes</span><span class="p">,</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">bytes</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

<a href="#ethereum_test_tools.common.types.Account.storage" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Storage within a contract.</p>
  </div>

</div>






<div class="doc doc-object doc-class">



<h3 id="ethereum_test_tools.common.types.Account.NonceMismatch" class="doc doc-heading">
        <code>NonceMismatch</code>


<a href="#ethereum_test_tools.common.types.Account.NonceMismatch" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code>Exception</code></p>

  
      <p>Test expected a certain nonce value for an account but a different
value was found.</p>


        <details class="quote">
          <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">NonceMismatch</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Test expected a certain nonce value for an account but a different</span>
<span class="sd">    value was found.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">address</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">want</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span>
    <span class="n">got</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">address</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">want</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="n">got</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">address</span> <span class="o">=</span> <span class="n">address</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">want</span> <span class="o">=</span> <span class="n">want</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">got</span> <span class="o">=</span> <span class="n">got</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Print exception string&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;unexpected nonce for account </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">address</span><span class="si">}</span><span class="s2">: &quot;</span>
            <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;want </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">want</span><span class="si">}</span><span class="s2">, got </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">got</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-function">



<h4 id="ethereum_test_tools.common.types.Account.NonceMismatch.__str__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__str__</span><span class="p">()</span></code>

<a href="#ethereum_test_tools.common.types.Account.NonceMismatch.__str__" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Print exception string</p>

      <details class="quote">
        <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Print exception string&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;unexpected nonce for account </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">address</span><span class="si">}</span><span class="s2">: &quot;</span>
        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;want </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">want</span><span class="si">}</span><span class="s2">, got </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">got</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>




  </div>

  </div>

</div>






<div class="doc doc-object doc-class">



<h3 id="ethereum_test_tools.common.types.Account.BalanceMismatch" class="doc doc-heading">
        <code>BalanceMismatch</code>


<a href="#ethereum_test_tools.common.types.Account.BalanceMismatch" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code>Exception</code></p>

  
      <p>Test expected a certain balance for an account but a different
value was found.</p>


        <details class="quote">
          <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">BalanceMismatch</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Test expected a certain balance for an account but a different</span>
<span class="sd">    value was found.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">address</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">want</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span>
    <span class="n">got</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">address</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">want</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="n">got</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">address</span> <span class="o">=</span> <span class="n">address</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">want</span> <span class="o">=</span> <span class="n">want</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">got</span> <span class="o">=</span> <span class="n">got</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Print exception string&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;unexpected balance for account </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">address</span><span class="si">}</span><span class="s2">: &quot;</span>
            <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;want </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">want</span><span class="si">}</span><span class="s2">, got </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">got</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-function">



<h4 id="ethereum_test_tools.common.types.Account.BalanceMismatch.__str__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__str__</span><span class="p">()</span></code>

<a href="#ethereum_test_tools.common.types.Account.BalanceMismatch.__str__" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Print exception string</p>

      <details class="quote">
        <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Print exception string&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;unexpected balance for account </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">address</span><span class="si">}</span><span class="s2">: &quot;</span>
        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;want </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">want</span><span class="si">}</span><span class="s2">, got </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">got</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>




  </div>

  </div>

</div>






<div class="doc doc-object doc-class">



<h3 id="ethereum_test_tools.common.types.Account.CodeMismatch" class="doc doc-heading">
        <code>CodeMismatch</code>


<a href="#ethereum_test_tools.common.types.Account.CodeMismatch" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code>Exception</code></p>

  
      <p>Test expected a certain bytecode for an account but a different
one was found.</p>


        <details class="quote">
          <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">CodeMismatch</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Test expected a certain bytecode for an account but a different</span>
<span class="sd">    one was found.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">address</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">want</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span>
    <span class="n">got</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">address</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">want</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="n">got</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">address</span> <span class="o">=</span> <span class="n">address</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">want</span> <span class="o">=</span> <span class="n">want</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">got</span> <span class="o">=</span> <span class="n">got</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Print exception string&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;unexpected code for account </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">address</span><span class="si">}</span><span class="s2">: &quot;</span>
            <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;want </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">want</span><span class="si">}</span><span class="s2">, got </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">got</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-function">



<h4 id="ethereum_test_tools.common.types.Account.CodeMismatch.__str__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__str__</span><span class="p">()</span></code>

<a href="#ethereum_test_tools.common.types.Account.CodeMismatch.__str__" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Print exception string</p>

      <details class="quote">
        <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Print exception string&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;unexpected code for account </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">address</span><span class="si">}</span><span class="s2">: &quot;</span>
        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;want </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">want</span><span class="si">}</span><span class="s2">, got </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">got</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>




  </div>

  </div>

</div>






<div class="doc doc-object doc-function">



<h3 id="ethereum_test_tools.common.types.Account.__post_init__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">__post_init__</span><span class="p">()</span></code>

<a href="#ethereum_test_tools.common.types.Account.__post_init__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Automatically init account members</p>

      <details class="quote">
        <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Automatically init account members&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">storage</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">storage</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">storage</span> <span class="o">=</span> <span class="n">Storage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">storage</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>






<div class="doc doc-object doc-function">



<h3 id="ethereum_test_tools.common.types.Account.check_alloc" class="doc doc-heading">
<code class="highlight language-python"><span class="n">check_alloc</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="n">alloc</span><span class="p">)</span></code>

<a href="#ethereum_test_tools.common.types.Account.check_alloc" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Checks the returned alloc against an expected account in post state.
Raises exception on failure.</p>

      <details class="quote">
        <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">check_alloc</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="s2">&quot;Account&quot;</span><span class="p">,</span> <span class="n">address</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">alloc</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks the returned alloc against an expected account in post state.</span>
<span class="sd">    Raises exception on failure.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nonce</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">actual_nonce</span> <span class="o">=</span> <span class="n">int_or_none</span><span class="p">(</span><span class="n">alloc</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;nonce&quot;</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nonce</span> <span class="o">!=</span> <span class="n">actual_nonce</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">Account</span><span class="o">.</span><span class="n">NonceMismatch</span><span class="p">(</span>
                <span class="n">address</span><span class="o">=</span><span class="n">address</span><span class="p">,</span>
                <span class="n">want</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nonce</span><span class="p">,</span>
                <span class="n">got</span><span class="o">=</span><span class="n">actual_nonce</span><span class="p">,</span>
            <span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">balance</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">actual_balance</span> <span class="o">=</span> <span class="n">int_or_none</span><span class="p">(</span><span class="n">alloc</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;balance&quot;</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">balance</span> <span class="o">!=</span> <span class="n">actual_balance</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">Account</span><span class="o">.</span><span class="n">BalanceMismatch</span><span class="p">(</span>
                <span class="n">address</span><span class="o">=</span><span class="n">address</span><span class="p">,</span>
                <span class="n">want</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">balance</span><span class="p">,</span>
                <span class="n">got</span><span class="o">=</span><span class="n">actual_balance</span><span class="p">,</span>
            <span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">code</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">expected_code</span> <span class="o">=</span> <span class="n">code_to_hex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">code</span><span class="p">)</span>
        <span class="n">actual_code</span> <span class="o">=</span> <span class="n">str_or_none</span><span class="p">(</span><span class="n">alloc</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;code&quot;</span><span class="p">),</span> <span class="s2">&quot;0x&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">expected_code</span> <span class="o">!=</span> <span class="n">actual_code</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">Account</span><span class="o">.</span><span class="n">CodeMismatch</span><span class="p">(</span>
                <span class="n">address</span><span class="o">=</span><span class="n">address</span><span class="p">,</span>
                <span class="n">want</span><span class="o">=</span><span class="n">expected_code</span><span class="p">,</span>
                <span class="n">got</span><span class="o">=</span><span class="n">actual_code</span><span class="p">,</span>
            <span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">storage</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">expected_storage</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">storage</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">storage</span><span class="p">,</span> <span class="n">Storage</span><span class="p">)</span> <span class="k">else</span> <span class="n">Storage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">storage</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">actual_storage</span> <span class="o">=</span> <span class="n">Storage</span><span class="p">(</span><span class="n">alloc</span><span class="p">[</span><span class="s2">&quot;storage&quot;</span><span class="p">])</span> <span class="k">if</span> <span class="s2">&quot;storage&quot;</span> <span class="ow">in</span> <span class="n">alloc</span> <span class="k">else</span> <span class="n">Storage</span><span class="p">({})</span>
        <span class="n">expected_storage</span><span class="o">.</span><span class="n">must_be_equal</span><span class="p">(</span><span class="n">actual_storage</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>






<div class="doc doc-object doc-function">



<h3 id="ethereum_test_tools.common.types.Account.with_code" class="doc doc-heading">
<code class="highlight language-python"><span class="n">with_code</span><span class="p">(</span><span class="n">code</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#ethereum_test_tools.common.types.Account.with_code" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Create account with provided <code>code</code> and nonce of <code>1</code>.</p>

      <details class="quote">
        <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">with_code</span><span class="p">(</span><span class="bp">cls</span><span class="p">:</span> <span class="n">Type</span><span class="p">,</span> <span class="n">code</span><span class="p">:</span> <span class="nb">bytes</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Code</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Account&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create account with provided `code` and nonce of `1`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">Account</span><span class="p">(</span><span class="n">nonce</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">code</span><span class="o">=</span><span class="n">code</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>




  </div>

  </div>

</div>






<div class="doc doc-object doc-class">



<h2 id="tests.eips.eip4844.test_blobhash_opcode.Transaction" class="doc doc-heading">
        <code>Transaction</code>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#tests.eips.eip4844.test_blobhash_opcode.Transaction" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">

  
      <p>Generic object that can represent all Ethereum transaction types.</p>


        <details class="quote">
          <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span><span class="p">(</span><span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">Transaction</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generic object that can represent all Ethereum transaction types.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">ty</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Transaction type value.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">chain_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">nonce</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">to</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">AddrAA</span>
    <span class="n">value</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Code</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">()</span>
    <span class="n">gas_limit</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">21000</span>
    <span class="n">access_list</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">AccessList</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">gas_price</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">max_fee_per_gas</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">max_priority_fee_per_gas</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">max_fee_per_data_gas</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">blob_versioned_hashes</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="nb">bytes</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">blob_kzgs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">bytes</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">blobs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">kzg_aggregated_proof</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="nb">bytes</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">signature</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">secret_key</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">protected</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">error</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">class</span> <span class="nc">InvalidFeePayment</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Transaction described more than one fee payment type.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;Print exception string&quot;&quot;&quot;</span>
            <span class="k">return</span> <span class="s2">&quot;only one type of fee payment field can be used in a single tx&quot;</span>

    <span class="k">class</span> <span class="nc">InvalidSignaturePrivateKey</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Transaction describes both the signature and private key of</span>
<span class="sd">        source account.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;Print exception string&quot;&quot;&quot;</span>
            <span class="k">return</span> <span class="s2">&quot;can&#39;t define both &#39;signature&#39; and &#39;private_key&#39;&quot;</span>

    <span class="k">def</span> <span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Ensures the transaction has no conflicting properties.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gas_price</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_fee_per_gas</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_priority_fee_per_gas</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="p">):</span>
            <span class="k">raise</span> <span class="n">Transaction</span><span class="o">.</span><span class="n">InvalidFeePayment</span><span class="p">()</span>

        <span class="k">if</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gas_price</span> <span class="ow">is</span> <span class="kc">None</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_fee_per_gas</span> <span class="ow">is</span> <span class="kc">None</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_priority_fee_per_gas</span> <span class="ow">is</span> <span class="kc">None</span>
        <span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gas_price</span> <span class="o">=</span> <span class="mi">10</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">signature</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">secret_key</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">Transaction</span><span class="o">.</span><span class="n">InvalidSignaturePrivateKey</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">signature</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">secret_key</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">secret_key</span> <span class="o">=</span> <span class="n">TestPrivateKey</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ty</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Try to deduce transaction type from included fields</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_fee_per_data_gas</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ty</span> <span class="o">=</span> <span class="mi">5</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_fee_per_gas</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ty</span> <span class="o">=</span> <span class="mi">2</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">access_list</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ty</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ty</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">with_error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">error</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Transaction&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a copy of the transaction with an added error.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tx</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">tx</span><span class="o">.</span><span class="n">error</span> <span class="o">=</span> <span class="n">error</span>
        <span class="k">return</span> <span class="n">tx</span>

    <span class="k">def</span> <span class="nf">with_nonce</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nonce</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Transaction&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a copy of the transaction with a modified nonce.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tx</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">tx</span><span class="o">.</span><span class="n">nonce</span> <span class="o">=</span> <span class="n">nonce</span>
        <span class="k">return</span> <span class="n">tx</span>

    <span class="k">def</span> <span class="nf">with_fields</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Transaction&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a deepcopy of the transaction with modified fields.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tx</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">tx</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="n">tx</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid field &#39;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">&#39; for Transaction&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">tx</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="ethereum_test_tools.common.types.Transaction.ty" class="doc doc-heading">
<code class="highlight language-python"><span class="n">ty</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

<a href="#ethereum_test_tools.common.types.Transaction.ty" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Transaction type value.</p>
  </div>

</div>






<div class="doc doc-object doc-class">



<h3 id="ethereum_test_tools.common.types.Transaction.InvalidFeePayment" class="doc doc-heading">
        <code>InvalidFeePayment</code>


<a href="#ethereum_test_tools.common.types.Transaction.InvalidFeePayment" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code>Exception</code></p>

  
      <p>Transaction described more than one fee payment type.</p>


        <details class="quote">
          <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">InvalidFeePayment</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Transaction described more than one fee payment type.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Print exception string&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s2">&quot;only one type of fee payment field can be used in a single tx&quot;</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-function">



<h4 id="ethereum_test_tools.common.types.Transaction.InvalidFeePayment.__str__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__str__</span><span class="p">()</span></code>

<a href="#ethereum_test_tools.common.types.Transaction.InvalidFeePayment.__str__" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Print exception string</p>

      <details class="quote">
        <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Print exception string&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="s2">&quot;only one type of fee payment field can be used in a single tx&quot;</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>




  </div>

  </div>

</div>






<div class="doc doc-object doc-class">



<h3 id="ethereum_test_tools.common.types.Transaction.InvalidSignaturePrivateKey" class="doc doc-heading">
        <code>InvalidSignaturePrivateKey</code>


<a href="#ethereum_test_tools.common.types.Transaction.InvalidSignaturePrivateKey" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code>Exception</code></p>

  
      <p>Transaction describes both the signature and private key of
source account.</p>


        <details class="quote">
          <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">InvalidSignaturePrivateKey</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Transaction describes both the signature and private key of</span>
<span class="sd">    source account.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Print exception string&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s2">&quot;can&#39;t define both &#39;signature&#39; and &#39;private_key&#39;&quot;</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-function">



<h4 id="ethereum_test_tools.common.types.Transaction.InvalidSignaturePrivateKey.__str__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__str__</span><span class="p">()</span></code>

<a href="#ethereum_test_tools.common.types.Transaction.InvalidSignaturePrivateKey.__str__" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Print exception string</p>

      <details class="quote">
        <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Print exception string&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="s2">&quot;can&#39;t define both &#39;signature&#39; and &#39;private_key&#39;&quot;</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>




  </div>

  </div>

</div>






<div class="doc doc-object doc-function">



<h3 id="ethereum_test_tools.common.types.Transaction.__post_init__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">__post_init__</span><span class="p">()</span></code>

<a href="#ethereum_test_tools.common.types.Transaction.__post_init__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Ensures the transaction has no conflicting properties.</p>

      <details class="quote">
        <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Ensures the transaction has no conflicting properties.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gas_price</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_fee_per_gas</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_priority_fee_per_gas</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
    <span class="p">):</span>
        <span class="k">raise</span> <span class="n">Transaction</span><span class="o">.</span><span class="n">InvalidFeePayment</span><span class="p">()</span>

    <span class="k">if</span> <span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gas_price</span> <span class="ow">is</span> <span class="kc">None</span>
        <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_fee_per_gas</span> <span class="ow">is</span> <span class="kc">None</span>
        <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_priority_fee_per_gas</span> <span class="ow">is</span> <span class="kc">None</span>
    <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gas_price</span> <span class="o">=</span> <span class="mi">10</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">signature</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">secret_key</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">Transaction</span><span class="o">.</span><span class="n">InvalidSignaturePrivateKey</span><span class="p">()</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">signature</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">secret_key</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">secret_key</span> <span class="o">=</span> <span class="n">TestPrivateKey</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ty</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Try to deduce transaction type from included fields</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_fee_per_data_gas</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ty</span> <span class="o">=</span> <span class="mi">5</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_fee_per_gas</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ty</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">access_list</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ty</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ty</span> <span class="o">=</span> <span class="mi">0</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>






<div class="doc doc-object doc-function">



<h3 id="ethereum_test_tools.common.types.Transaction.with_error" class="doc doc-heading">
<code class="highlight language-python"><span class="n">with_error</span><span class="p">(</span><span class="n">error</span><span class="p">)</span></code>

<a href="#ethereum_test_tools.common.types.Transaction.with_error" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Create a copy of the transaction with an added error.</p>

      <details class="quote">
        <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">with_error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">error</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Transaction&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a copy of the transaction with an added error.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">tx</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="n">tx</span><span class="o">.</span><span class="n">error</span> <span class="o">=</span> <span class="n">error</span>
    <span class="k">return</span> <span class="n">tx</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>






<div class="doc doc-object doc-function">



<h3 id="ethereum_test_tools.common.types.Transaction.with_nonce" class="doc doc-heading">
<code class="highlight language-python"><span class="n">with_nonce</span><span class="p">(</span><span class="n">nonce</span><span class="p">)</span></code>

<a href="#ethereum_test_tools.common.types.Transaction.with_nonce" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Create a copy of the transaction with a modified nonce.</p>

      <details class="quote">
        <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">with_nonce</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nonce</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Transaction&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a copy of the transaction with a modified nonce.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">tx</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="n">tx</span><span class="o">.</span><span class="n">nonce</span> <span class="o">=</span> <span class="n">nonce</span>
    <span class="k">return</span> <span class="n">tx</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>






<div class="doc doc-object doc-function">



<h3 id="ethereum_test_tools.common.types.Transaction.with_fields" class="doc doc-heading">
<code class="highlight language-python"><span class="n">with_fields</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#ethereum_test_tools.common.types.Transaction.with_fields" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Create a deepcopy of the transaction with modified fields.</p>

      <details class="quote">
        <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">with_fields</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Transaction&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a deepcopy of the transaction with modified fields.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">tx</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">tx</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">tx</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid field &#39;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">&#39; for Transaction&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">tx</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>




  </div>

  </div>

</div>






<div class="doc doc-object doc-class">



<h2 id="tests.eips.eip4844.test_blobhash_opcode.Block" class="doc doc-heading">
        <code>Block</code>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#tests.eips.eip4844.test_blobhash_opcode.Block" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><a class="autorefs autorefs-internal" title="ethereum_test_tools.common.types.Header" href="../test_excess_data_gas/#tests.eips.eip4844.test_excess_data_gas.Header">Header</a></code></p>

  
      <p>Block type used to describe block properties in test specs</p>


        <details class="quote">
          <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 918</span>
<span class="normal"> 919</span>
<span class="normal"> 920</span>
<span class="normal"> 921</span>
<span class="normal"> 922</span>
<span class="normal"> 923</span>
<span class="normal"> 924</span>
<span class="normal"> 925</span>
<span class="normal"> 926</span>
<span class="normal"> 927</span>
<span class="normal"> 928</span>
<span class="normal"> 929</span>
<span class="normal"> 930</span>
<span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span><span class="p">(</span><span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">Block</span><span class="p">(</span><span class="n">Header</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Block type used to describe block properties in test specs</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">rlp</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    If set, blockchain test will skip generating the block using</span>
<span class="sd">    `evm_block_builder`, and will pass this value directly to the Fixture.</span>

<span class="sd">    Only meant to be used to simulate blocks with bad formats, and therefore</span>
<span class="sd">    requires the block to produce an exception.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">rlp_modifier</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Header</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    An RLP modifying header which values would be used to override the ones</span>
<span class="sd">    returned by the  `evm_transition_tool`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">exception</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    If set, the block is expected to be rejected by the client.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">txs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Transaction</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    List of transactions included in the block.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ommers</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Header</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    List of ommer headers included in the block.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">withdrawals</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Withdrawal</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    List of withdrawals to perform for this block.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">set_environment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">env</span><span class="p">:</span> <span class="n">Environment</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Environment</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a copy of the environment with the characteristics of this</span>
<span class="sd">        specific block.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_env</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">env</span><span class="p">)</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Values that need to be set in the environment and are `None` for</span>
<span class="sd">        this block need to be set to their defaults.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">environment_default</span> <span class="o">=</span> <span class="n">Environment</span><span class="p">()</span>
        <span class="n">new_env</span><span class="o">.</span><span class="n">difficulty</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">difficulty</span>
        <span class="n">new_env</span><span class="o">.</span><span class="n">coinbase</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">coinbase</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">coinbase</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">environment_default</span><span class="o">.</span><span class="n">coinbase</span>
        <span class="p">)</span>
        <span class="n">new_env</span><span class="o">.</span><span class="n">gas_limit</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gas_limit</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas_limit</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">environment_default</span><span class="o">.</span><span class="n">gas_limit</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_fee</span><span class="p">,</span> <span class="n">Removable</span><span class="p">):</span>
            <span class="n">new_env</span><span class="o">.</span><span class="n">base_fee</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_fee</span>
        <span class="n">new_env</span><span class="o">.</span><span class="n">withdrawals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">withdrawals</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">excess_data_gas</span><span class="p">,</span> <span class="n">Removable</span><span class="p">):</span>
            <span class="n">new_env</span><span class="o">.</span><span class="n">excess_data_gas</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">excess_data_gas</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        These values are required, but they depend on the previous environment,</span>
<span class="sd">        so they can be calculated here.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">number</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">new_env</span><span class="o">.</span><span class="n">number</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">number</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># calculate the next block number for the environment</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_env</span><span class="o">.</span><span class="n">block_hashes</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">new_env</span><span class="o">.</span><span class="n">number</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">new_env</span><span class="o">.</span><span class="n">number</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">new_env</span><span class="o">.</span><span class="n">block_hashes</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">+</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">timestamp</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">new_env</span><span class="o">.</span><span class="n">timestamp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">timestamp</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">new_env</span><span class="o">.</span><span class="n">parent_timestamp</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="n">new_env</span><span class="o">.</span><span class="n">timestamp</span> <span class="o">=</span> <span class="n">new_env</span><span class="o">.</span><span class="n">parent_timestamp</span> <span class="o">+</span> <span class="mi">12</span>

        <span class="k">return</span> <span class="n">new_env</span>

    <span class="k">def</span> <span class="nf">copy_with_rlp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rlp</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Block&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a copy of the block and adds the specified RLP.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_block</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">new_block</span><span class="o">.</span><span class="n">rlp</span> <span class="o">=</span> <span class="n">rlp</span>
        <span class="k">return</span> <span class="n">new_block</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="ethereum_test_tools.common.types.Block.rlp" class="doc doc-heading">
<code class="highlight language-python"><span class="n">rlp</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

<a href="#ethereum_test_tools.common.types.Block.rlp" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>If set, blockchain test will skip generating the block using
<code>evm_block_builder</code>, and will pass this value directly to the Fixture.</p>
<p>Only meant to be used to simulate blocks with bad formats, and therefore
requires the block to produce an exception.</p>
  </div>

</div>






<div class="doc doc-object doc-attribute">



<h3 id="ethereum_test_tools.common.types.Block.rlp_modifier" class="doc doc-heading">
<code class="highlight language-python"><span class="n">rlp_modifier</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Header</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

<a href="#ethereum_test_tools.common.types.Block.rlp_modifier" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>An RLP modifying header which values would be used to override the ones
returned by the  <code>evm_transition_tool</code>.</p>
  </div>

</div>






<div class="doc doc-object doc-attribute">



<h3 id="ethereum_test_tools.common.types.Block.exception" class="doc doc-heading">
<code class="highlight language-python"><span class="n">exception</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

<a href="#ethereum_test_tools.common.types.Block.exception" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>If set, the block is expected to be rejected by the client.</p>
  </div>

</div>






<div class="doc doc-object doc-attribute">



<h3 id="ethereum_test_tools.common.types.Block.txs" class="doc doc-heading">
<code class="highlight language-python"><span class="n">txs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Transaction</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

<a href="#ethereum_test_tools.common.types.Block.txs" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>List of transactions included in the block.</p>
  </div>

</div>






<div class="doc doc-object doc-attribute">



<h3 id="ethereum_test_tools.common.types.Block.ommers" class="doc doc-heading">
<code class="highlight language-python"><span class="n">ommers</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Header</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

<a href="#ethereum_test_tools.common.types.Block.ommers" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>List of ommer headers included in the block.</p>
  </div>

</div>






<div class="doc doc-object doc-attribute">



<h3 id="ethereum_test_tools.common.types.Block.withdrawals" class="doc doc-heading">
<code class="highlight language-python"><span class="n">withdrawals</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Withdrawal</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

<a href="#ethereum_test_tools.common.types.Block.withdrawals" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>List of withdrawals to perform for this block.</p>
  </div>

</div>






<div class="doc doc-object doc-function">



<h3 id="ethereum_test_tools.common.types.Block.set_environment" class="doc doc-heading">
<code class="highlight language-python"><span class="n">set_environment</span><span class="p">(</span><span class="n">env</span><span class="p">)</span></code>

<a href="#ethereum_test_tools.common.types.Block.set_environment" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Creates a copy of the environment with the characteristics of this
specific block.</p>

      <details class="quote">
        <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">954</span>
<span class="normal">955</span>
<span class="normal">956</span>
<span class="normal">957</span>
<span class="normal">958</span>
<span class="normal">959</span>
<span class="normal">960</span>
<span class="normal">961</span>
<span class="normal">962</span>
<span class="normal">963</span>
<span class="normal">964</span>
<span class="normal">965</span>
<span class="normal">966</span>
<span class="normal">967</span>
<span class="normal">968</span>
<span class="normal">969</span>
<span class="normal">970</span>
<span class="normal">971</span>
<span class="normal">972</span>
<span class="normal">973</span>
<span class="normal">974</span>
<span class="normal">975</span>
<span class="normal">976</span>
<span class="normal">977</span>
<span class="normal">978</span>
<span class="normal">979</span>
<span class="normal">980</span>
<span class="normal">981</span>
<span class="normal">982</span>
<span class="normal">983</span>
<span class="normal">984</span>
<span class="normal">985</span>
<span class="normal">986</span>
<span class="normal">987</span>
<span class="normal">988</span>
<span class="normal">989</span>
<span class="normal">990</span>
<span class="normal">991</span>
<span class="normal">992</span>
<span class="normal">993</span>
<span class="normal">994</span>
<span class="normal">995</span>
<span class="normal">996</span>
<span class="normal">997</span>
<span class="normal">998</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">set_environment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">env</span><span class="p">:</span> <span class="n">Environment</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Environment</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a copy of the environment with the characteristics of this</span>
<span class="sd">    specific block.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">new_env</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">env</span><span class="p">)</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Values that need to be set in the environment and are `None` for</span>
<span class="sd">    this block need to be set to their defaults.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">environment_default</span> <span class="o">=</span> <span class="n">Environment</span><span class="p">()</span>
    <span class="n">new_env</span><span class="o">.</span><span class="n">difficulty</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">difficulty</span>
    <span class="n">new_env</span><span class="o">.</span><span class="n">coinbase</span> <span class="o">=</span> <span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coinbase</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">coinbase</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">environment_default</span><span class="o">.</span><span class="n">coinbase</span>
    <span class="p">)</span>
    <span class="n">new_env</span><span class="o">.</span><span class="n">gas_limit</span> <span class="o">=</span> <span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gas_limit</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas_limit</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">environment_default</span><span class="o">.</span><span class="n">gas_limit</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_fee</span><span class="p">,</span> <span class="n">Removable</span><span class="p">):</span>
        <span class="n">new_env</span><span class="o">.</span><span class="n">base_fee</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_fee</span>
    <span class="n">new_env</span><span class="o">.</span><span class="n">withdrawals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">withdrawals</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">excess_data_gas</span><span class="p">,</span> <span class="n">Removable</span><span class="p">):</span>
        <span class="n">new_env</span><span class="o">.</span><span class="n">excess_data_gas</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">excess_data_gas</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    These values are required, but they depend on the previous environment,</span>
<span class="sd">    so they can be calculated here.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">number</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">new_env</span><span class="o">.</span><span class="n">number</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">number</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># calculate the next block number for the environment</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_env</span><span class="o">.</span><span class="n">block_hashes</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">new_env</span><span class="o">.</span><span class="n">number</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">new_env</span><span class="o">.</span><span class="n">number</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">new_env</span><span class="o">.</span><span class="n">block_hashes</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">+</span> <span class="mi">1</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">timestamp</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">new_env</span><span class="o">.</span><span class="n">timestamp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">timestamp</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">assert</span> <span class="n">new_env</span><span class="o">.</span><span class="n">parent_timestamp</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="n">new_env</span><span class="o">.</span><span class="n">timestamp</span> <span class="o">=</span> <span class="n">new_env</span><span class="o">.</span><span class="n">parent_timestamp</span> <span class="o">+</span> <span class="mi">12</span>

    <span class="k">return</span> <span class="n">new_env</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>






<div class="doc doc-object doc-function">



<h3 id="ethereum_test_tools.common.types.Block.copy_with_rlp" class="doc doc-heading">
<code class="highlight language-python"><span class="n">copy_with_rlp</span><span class="p">(</span><span class="n">rlp</span><span class="p">)</span></code>

<a href="#ethereum_test_tools.common.types.Block.copy_with_rlp" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Creates a copy of the block and adds the specified RLP.</p>

      <details class="quote">
        <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">copy_with_rlp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rlp</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Block&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a copy of the block and adds the specified RLP.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">new_block</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="n">new_block</span><span class="o">.</span><span class="n">rlp</span> <span class="o">=</span> <span class="n">rlp</span>
    <span class="k">return</span> <span class="n">new_block</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>




  </div>

  </div>

</div>




  </div>

  </div>

</div>





                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright: 2023, Ethereum Community
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../../..", "features": ["content.code.copy", "search.suggest", "search.highlight", "content.tabs.link", "navigation.indexes", "navigation.instant", "navigation.tabs"], "search": "../../../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.b4d07000.min.js"></script>
      
    
  <script>document$.subscribe(() => {const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});})</script></body>
</html>